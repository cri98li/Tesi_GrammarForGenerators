{"$schema":"http:\/\/json-schema.org\/draft-04\/schema#","description":"schema for an JSON Tredlyfile","id":"https:\/\/tredly.com\/docs\/tredlyfile-json-schema#","type":"object","definitions":{"_88operationExec":{"additionalProperties":false,"type":"object","properties":{"___type":{"type":"string","enum":["exec"]},"___value":{"type":"string"}},"required":["value"]},"_88positiveInteger":{"type":"integer","minimum":0},"_88validIpv4WithCidr":{"pattern":"^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(\/([0-9]|[1-2][0-9]|3[0-2]))?$","type":"string"},"_88arrayOfOperations":{"type":"array","items":{"oneOf":[{"$eref":{"additionalProperties":false,"type":"object","properties":{"___type":{"type":"string","enum":["exec"]},"___value":{"type":"string"}},"required":["value"]}},{"$eref":{"additionalProperties":false,"type":"object","properties":{"___target":{"type":"string"},"___type":{"type":"string","enum":["fileFolderMapping"]},"___source":{"type":"string"}},"required":["source","target"]}},{"$eref":{"additionalProperties":false,"type":"object","properties":{"___type":{"type":"string","enum":["installPackage"]},"___value":{"type":"string"}},"required":["value"]}}]}},"_88typeSizeMegabyte":{"pattern":"^[0-9]+(m|M)(b|B)?$","type":"string"},"_88inOutPorts":{"additionalProperties":false,"type":"object","properties":{"___in":{"default":{},"uniqueItems":true,"type":"array","items":{"oneOf":[{"$eref":{"maximum":65535,"type":"integer","minimum":1}},{"$eref":{"type":"string","enum":["any"]}}]}},"___out":{"default":{},"uniqueItems":true,"type":"array","items":{"oneOf":[{"$eref":{"maximum":65535,"type":"integer","minimum":1}},{"$eref":{"type":"string","enum":["any"]}}]}}}},"_88validPort":{"maximum":65535,"type":"integer","minimum":1},"_88stringPath":{"pattern":"^\/","type":"string"},"_88uriProtocolHttps":{"pattern":"^https:\\\/\\\/","type":"string"},"_88arrayOfExecOperationsOnly":{"type":"array","items":{"$eref":{"additionalProperties":false,"type":"object","properties":{"___type":{"type":"string","enum":["exec"]},"___value":{"type":"string"}},"required":["value"]}}},"_88validAnyPort":{"type":"string","enum":["any"]},"_88operationFolderFileMapping":{"additionalProperties":false,"type":"object","properties":{"___target":{"type":"string"},"___type":{"type":"string","enum":["fileFolderMapping"]},"___source":{"type":"string"}},"required":["source","target"]},"_88validIpv4":{"pattern":"^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$"},"_88uriProtocolHttp":{"pattern":"^http:\\\/\\\/","type":"string"},"_88operationInstallPackage":{"additionalProperties":false,"type":"object","properties":{"___type":{"type":"string","enum":["installPackage"]},"___value":{"type":"string"}},"required":["value"]},"_88httpRedirect":{"additionalProperties":false,"type":"object","properties":{"___url":{"$eref":{"pattern":"^http:\\\/\\\/","type":"string"}},"___cert":{"type":"null","enum":[null]}},"required":["url","cert"]},"_88httpsRedirect":{"additionalProperties":false,"type":"object","properties":{"___url":{"$eref":{"pattern":"^https:\\\/\\\/","type":"string"}},"___cert":{"description":"SSL certificate to apply to a http redirect 'from' URL.","type":"string"}},"required":["url","cert"]},"_88binaryStringType":{"type":"string","enum":["0","1"]},"_88typeSizeGigabyte":{"pattern":"^[0-9]+(g|G)(b|B)?$","type":"string"},"_88resourceUnlimited":{"type":"string","enum":["unlimited"]}},"properties":{"___container":{"type":"object","properties":{"___customDNS":{"default":{},"uniqueItems":true,"optional":true,"type":"array","items":{"$eref":{"pattern":"^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$"}}},"___restrictTo":{"oneOf":[{"pattern":"^(\\*|[0-9](?:\\.(\\*|[0-9]{1,}(?:\\.(\\*|[0-9]{1,}))?)?)?)$","type":"string"},{"type":"null"},{"type":"string","maxLength":0}],"description":"The version of Tredly this file is compatible with."},"___operations":{"additionalProperties":false,"type":"object","properties":{"___onStart":{"$eref":{"type":"array","items":{"$ref":"#\/definitions\/operationExec"}}},"___onStop":{"$eref":{"type":"array","items":{"$ref":"#\/definitions\/operationExec"}}},"___onCreate":{"$eref":{"type":"array","items":{"oneOf":[{"$ref":"#\/definitions\/operationExec"},{"$ref":"#\/definitions\/operationFolderFileMapping"},{"$ref":"#\/definitions\/operationInstallPackage"}]}}},"___onDestroy":{"$eref":{"type":"array","items":{"$ref":"#\/definitions\/operationExec"}}}}},"___technicalOptions":{"description":"These options will be set when the container is created.","optional":true,"additionalProperties":false,"type":"object","properties":{"___devfs_ruleset":{"$eref":{"type":"integer","minimum":0}},"___stop.timeout":{"$eref":{"type":"string","enum":["0","1"]}},"___allow.mount.tmpfs":{"$eref":{"type":"string","enum":["0","1"]}},"___enforce_statfs":{"$eref":{"type":"string","enum":["0","1"]}},"___exec.fib":{"$eref":{"type":"string","enum":["0","1"]}},"___allow.mount.procfs":{"$eref":{"type":"string","enum":["0","1"]}},"___mount.fdescfs":{"$eref":{"type":"string","enum":["0","1"]}},"___allow.mount.zfs":{"$eref":{"type":"string","enum":["0","1"]}},"___allow.sysvipc":{"$eref":{"type":"string","enum":["0","1"]}},"___exec.prestart":{"$eref":{"pattern":"^\/","type":"string"}},"___exec.prestop":{"$eref":{"pattern":"^\/","type":"string"}},"___allow.set_hostname":{"$eref":{"type":"string","enum":["0","1"]}},"___exec.clean":{"$eref":{"type":"string","enum":["0","1"]}},"___children.max":{"$eref":{"type":"integer","minimum":0}},"___allow.mount.nullfs":{"$eref":{"type":"string","enum":["0","1"]}},"___exec.poststart":{"$eref":{"pattern":"^\/","type":"string"}},"___allow.mount":{"$eref":{"type":"string","enum":["0","1"]}},"___allow.raw_sockets":{"$eref":{"type":"string","enum":["0","1"]}},"___allow.chflags":{"$eref":{"type":"string","enum":["0","1"]}},"___allow.mount.devfs":{"$eref":{"type":"string","enum":["0","1"]}},"___allow.quotas":{"$eref":{"type":"string","enum":["0","1"]}},"___mount.devfs":{"$eref":{"type":"string","enum":["0","1"]}},"___exec.timeout":{"$eref":{"type":"string","enum":["0","1"]}},"___exec.stop":{"$eref":{"pattern":"^\/","type":"string"}},"___allow.socket_af":{"$eref":{"type":"string","enum":["0","1"]}},"___securelevel":{"maximum":3,"type":"integer","minimum":-1}}},"___firewall":{"optional":true,"type":"object","properties":{"___allowPorts":{"uniqueItems":true,"optional":true,"additionalProperties":false,"type":"object","properties":{"___udp":{"$eref":{"additionalProperties":false,"type":"object","properties":{"___in":{"default":{},"uniqueItems":true,"type":"array","items":{"oneOf":[{"$ref":"#\/definitions\/validPort"},{"$ref":"#\/definitions\/validAnyPort"}]}},"___out":{"default":{},"uniqueItems":true,"type":"array","items":{"oneOf":[{"$ref":"#\/definitions\/validPort"},{"$ref":"#\/definitions\/validAnyPort"}]}}}}},"___tcp":{"$eref":{"additionalProperties":false,"type":"object","properties":{"___in":{"default":{},"uniqueItems":true,"type":"array","items":{"oneOf":[{"$ref":"#\/definitions\/validPort"},{"$ref":"#\/definitions\/validAnyPort"}]}},"___out":{"default":{},"uniqueItems":true,"type":"array","items":{"oneOf":[{"$ref":"#\/definitions\/validPort"},{"$ref":"#\/definitions\/validAnyPort"}]}}}}}}},"___ipv4Whitelist":{"default":{},"uniqueItems":true,"optional":true,"type":"array","items":{"$eref":{"pattern":"^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(\/([0-9]|[1-2][0-9]|3[0-2]))?$","type":"string"}}}}},"___resourceLimits":{"description":"Limit resources used by this container.","additionalProperties":false,"type":"object","properties":{"___maxCpu":{"default":"unlimited","oneOf":[{"pattern":"^[0-9]+%$","type":"string"},{"type":"integer","minimum":1},{"$eref":{"type":"string","enum":["unlimited"]}}],"description":"The total number of cores or percent this container can utilise.","optional":true},"___maxHdd":{"default":"unlimited","oneOf":[{"$eref":{"pattern":"^[0-9]+(m|M)(b|B)?$","type":"string"}},{"$eref":{"pattern":"^[0-9]+(g|G)(b|B)?$","type":"string"}},{"$eref":{"type":"string","enum":["unlimited"]}}],"description":"The total amount of disk space, in Gigabytes (G) or Megabytes (M), this container.","optional":true},"___maxRam":{"default":"unlimited","oneOf":[{"$eref":{"pattern":"^[0-9]+(m|M)(b|B)?$","type":"string"}},{"$eref":{"pattern":"^[0-9]+(g|G)(b|B)?$","type":"string"}},{"$eref":{"type":"string","enum":["unlimited"]}}],"description":"The total amount of RAM, in Gigabytes (G) or Megabytes (M), this container can utilise.","optional":true}}},"___startOrder":{"default":1,"description":"Order in which this container is started within your container group.","maximum":99,"type":"integer","minimum":1},"___name":{"pattern":"^[-_a-zA-Z0-9]+$","description":"Unique per partition. Hostname of this container will this value","type":"string"},"___proxy":{"additionalProperties":false,"type":"object","properties":{"___layer4Proxy":{"default":false,"description":"Layer4 proxy allows the container to use the Hosts external IP and forward traffic to your container on specific ports.","type":"boolean"},"___layer7Proxy":{"description":"Group of properties for URL(s) the container services and responds to.","optional":true,"type":"array","items":{"additionalProperties":false,"type":"object","properties":{"___url":{"type":"string"},"___redirects":{"optional":true,"type":"array","items":{"anyOf":[{"$eref":{"additionalProperties":false,"type":"object","properties":{"___url":{"$ref":"#\/definitions\/uriProtocolHttp"},"___cert":{"type":"null","enum":[null]}},"required":["url","cert"]}},{"$eref":{"additionalProperties":false,"type":"object","properties":{"___url":{"$ref":"#\/definitions\/uriProtocolHttps"},"___cert":{"description":"SSL certificate to apply to a http redirect 'from' URL.","type":"string"}},"required":["url","cert"]}}],"type":"object"}},"___cert":{"type":["string","null"]},"___maxFileSize":{"default":"1m","pattern":"^[0-9]+(m|g)$","optional":true,"type":"string"},"___errorResponse":{"default":true,"type":"boolean"},"___enableWebsocket":{"default":false,"optional":true,"type":"boolean"}},"required":["url","cert"]}}},"required":["layer4Proxy"]},"___persistentStorage":{"description":"Create a persistent block of storage for this container","optional":true,"additionalProperties":false,"type":"object","properties":{"___mountPoint":{"$eref":{"pattern":"^\/","type":"string"},"description":"The path within the container that the persistent storage will be mounted."},"___identifier":{"pattern":"^[-_a-zA-Z0-9]+$","description":"A unique name to identify this block of persistent storage.","type":"string"}},"required":["identifier","mountPoint"]},"___group":{"oneOf":[{"pattern":"^[-_a-zA-Z0-9]+$","type":"string"},{"type":"null"},{"type":"string","maxLength":0}],"description":"Add this container to a particular group.","optional":true},"___buildOptions":{"additionalProperties":false,"type":"object","properties":{"___publish":{"default":true,"description":"When set to true, on push to a Tredly host this container will be automatically validated and built.","type":"boolean"}},"required":["publish"]},"___replicate":{"default":false,"description":"When set to yes, this allows a container to be replicated within its container group. This is required if 'group' has been set.","type":"boolean"}}}},"required":["container"]}