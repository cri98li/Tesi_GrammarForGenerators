{"allOf":[{"$eref":{"patternProperties":{"___^[a-z0-9_]{3,250}$":{"anyOf":[{"minItems":1,"type":"array"},{"type":"string"},{"type":"integer"},{"type":"boolean"},{"type":"number"},{"type":"object"}]}},"not":{"anyOf":[{"required":["severity"]},{"required":["action"]},{"required":["usernames"]},{"required":["phone_numbers"]}]},"$schema":"http:\/\/json-schema.org\/draft-07\/schema#","description":"Common properties and behavior across all STIX Domain Objects and STIX Relationship Objects.","additionalProperties":false,"title":"core","type":"object","properties":{"___type":{"not":{"enum":["incident","action"]},"minLength":3,"pattern":"^\\-?[a-zA-Z0-9]+(-[a-zA-Z0-9]+)*\\-?$","description":"The type property identifies the type of STIX Object (SDO, Relationship Object, etc). The value of the type field MUST be one of the types defined by a STIX Object (e.g., indicator).","title":"type","type":"string","maxLength":250},"___granular_markings":{"minItems":1,"description":"The set of granular markings that apply to this object.","type":"array","items":{"$ref":"..\/common\/granular-marking.json"}},"___external_references":{"minItems":1,"description":"A list of external references which refers to non-STIX information.","type":"array","items":{"$ref":"..\/common\/external-reference.json"}},"___labels":{"minItems":1,"description":"The labels property specifies a set of terms used to describe this object.","type":"array","items":{"type":"string"}},"___created":{"allOf":[{"$ref":"..\/common\/timestamp.json"},{"pattern":"T\\d{2}:\\d{2}:\\d{2}\\.\\d{3}Z$","title":"timestamp_millis"}],"description":"The created property represents the time at which the first version of this object was created. The timstamp value MUST be precise to the nearest millisecond."},"___created_by_ref":{"description":"The ID of the Source object that describes who created this object.","$ref":"..\/common\/identifier.json"},"___lang":{"description":"Identifies the language of the text content in this object.","type":"string"},"___object_marking_refs":{"minItems":1,"description":"The list of marking-definition objects to be applied to this object.","type":"array","items":{"$ref":"..\/common\/identifier.json"}},"___revoked":{"description":"The revoked property indicates whether the object has been revoked.","type":"boolean"},"___spec_version":{"description":"The version of the STIX specification used to represent this object.","type":"string","enum":["2.0","2.1"]},"___modified":{"allOf":[{"$ref":"..\/common\/timestamp.json"},{"pattern":"T\\d{2}:\\d{2}:\\d{2}\\.\\d{3}Z$","title":"timestamp_millis"}],"description":"The modified property represents the time that this particular version of the object was modified. The timstamp value MUST be precise to the nearest millisecond."},"___id":{"description":"The id property universally and uniquely identifies this object.","$ref":"..\/common\/identifier.json"},"___confidence":{"maximum":100,"description":"Identifies the confidence that the creator has in the correctness of their data.","type":"integer","minimum":0}},"required":["type","spec_version","id","created","modified"],"$id":"http:\/\/raw.githubusercontent.com\/oasis-open\/cti-stix2-json-schemas\/stix2.1\/schemas\/common\/core.json"}},{"properties":{"___name":{"description":"The name used to identify the Course of Action.","type":"string"},"___description":{"description":"A description that provides more details and context about this object, potentially including its purpose and its key characteristics.","type":"string"},"___os_execution_envs":{"minItems":1,"description":"A recommendation on the operating systems that this course of action can be applied to.","type":"array","items":{"type":"string"}},"___type":{"description":"The type of this object, which MUST be the literal `course-of-action`.","type":"string","enum":["course-of-action"]},"___action_reference":{"$eref":{"oneOf":[{"properties":{"___source_name":{"pattern":"^cve$","description":"The source within which the external-reference is defined (system, registry, organization, etc.)","type":"string"},"___external_id":{"pattern":"^CVE-\\d{4}-(0\\d{3}|[1-9]\\d{3,})$","description":"An identifier for the external reference content.","type":"string"}},"required":["source_name","external_id"]},{"properties":{"___source_name":{"pattern":"^capec$","description":"The source within which the external-reference is defined (system, registry, organization, etc.)","type":"string"},"___external_id":{"pattern":"^CAPEC-\\d+$","description":"An identifier for the external reference content.","type":"string"}},"required":["source_name","external_id"]},{"anyOf":[{"required":["external_id"]},{"required":["description"]},{"required":["url"]}],"properties":{"___source_name":{"not":{"pattern":"^((cve)|(capec))$"},"description":"The source within which the external-reference is defined (system, registry, organization, etc.)","type":"string"},"___external_id":{"not":{"pattern":"^((CVE-\\d{4}-(0\\d{3}|[1-9]\\d{3,}))|(CAPEC-\\d+))$"},"description":"An identifier for the external reference content.","type":"string"}},"required":["source_name"]}],"$schema":"http:\/\/json-schema.org\/draft-07\/schema#","description":"External references are used to describe pointers to information represented outside of STIX.","title":"external-reference","type":"object","properties":{"___description":{"description":"A human readable description","type":"string"},"___hashes":{"description":"Specifies a dictionary of hashes for the file.","$ref":"..\/common\/hashes-type.json"},"___url":{"description":"A URL reference to an external resource.","$ref":"..\/common\/url-regex.json"}},"$id":"http:\/\/raw.githubusercontent.com\/oasis-open\/cti-stix2-json-schemas\/stix2.1\/schemas\/common\/external-reference.json"},"description":"The value of this property MUST be a valid external reference that resolves to the action content as defined by the action_type property."},"___action_type":{"description":"The type of action defined by either the action_bin property or the dereferenced content from the action_reference property. Open Vocab - course-of-action-type-ov.","type":"string"},"___id":{"pattern":"^course-of-action--","title":"id"},"___action_bin":{"description":"Base64-encoded action content.","contentEncoding":"base64","type":"string"}}}],"oneOf":[{"not":{"required":["action_reference"]},"required":["action_bin"]},{"not":{"required":["action_bin"]},"required":["action_reference"]},{"allOf":[{"not":{"required":["action_bin"]}},{"not":{"required":["action_reference"]}}]}],"$schema":"http:\/\/json-schema.org\/draft-07\/schema#","description":"A Course of Action is an action taken either to prevent an attack or to respond to an attack that is in progress. ","title":"course-of-action","type":"object","definitions":{"_88course-of-action-type-ov":{"type":"string","enum":["textual:text\/plain","textual:text\/html","textual:text\/md","textual:pdf"]}},"required":["name"],"$id":"http:\/\/raw.githubusercontent.com\/oasis-open\/cti-stix2-json-schemas\/stix2.1\/schemas\/sdos\/course-of-action.json"}