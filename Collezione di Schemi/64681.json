{"oneOf":[{"oneOf":[{"properties":{"___definition":{"$eref":{"description":"The Statement marking type defines the representation of a textual marking statement (e.g., copyright, terms of use, etc.) in a definition","type":"object","properties":{"___statement":{"description":"A statement (e.g., copyright, terms of use) applied to the content marked by this marking definition.","type":"string"}},"required":["statement"]},"description":"The definition property contains the marking object itself."},"___definition_type":{"pattern":"^statement$","description":"The definition_type property identifies the type of Marking Definition.","type":"string"}}},{"properties":{"___definition":{"description":"The definition property contains the marking object itself.","type":"object"},"___definition_type":{"not":{"pattern":"^(statement)|(tlp)$"},"description":"The definition_type property identifies the type of Marking Definition.","type":"string"}}}],"properties":{"___id":{"allOf":[{"$eref":{"$schema":"http:\/\/json-schema.org\/draft-07\/schema#","pattern":"^[a-z0-9][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$","description":"Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.","title":"identifier","type":"string","$id":"http:\/\/raw.githubusercontent.com\/oasis-open\/cti-stix2-json-schemas\/stix2.1\/schemas\/common\/identifier.json"}},{"pattern":"^marking-definition--","description":"An identifier for this bundle.","title":"id"}]}},"required":["id","type","spec_version","definition","definition_type","created"]},{"oneOf":[{"$eref":{"description":"The marking-definition object representing Traffic Light Protocol (TLP) White.","properties":{"___definition":{"type":"object","properties":{"___tlp":{"type":"string","enum":["white"]}}},"___id":{"type":"string","enum":["marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"]}}}},{"$eref":{"description":"The marking-definition object representing Traffic Light Protocol (TLP) Green.","properties":{"___definition":{"type":"object","properties":{"___tlp":{"type":"string","enum":["green"]}}},"___id":{"type":"string","enum":["marking-definition--34098fce-860f-48ae-8e50-ebd3cc5e41da"]}}}},{"$eref":{"description":"The marking-definition object representing Traffic Light Protocol (TLP) Amber.","properties":{"___definition":{"type":"object","properties":{"___tlp":{"type":"string","enum":["amber"]}}},"___id":{"type":"string","enum":["marking-definition--f88d31f6-486f-44da-b317-01333bde0b82"]}}}},{"$eref":{"description":"The marking-definition object representing Traffic Light Protocol (TLP) Red.","properties":{"___definition":{"type":"object","properties":{"___tlp":{"type":"string","enum":["red"]}}},"___id":{"type":"string","enum":["marking-definition--5e57c739-391a-4eb3-b6be-7d15ca92d5ed"]}}}}],"description":"The TLP marking type defines how you would represent a Traffic Light Protocol (TLP) marking in a definition field.","properties":{"___definition_type":{"type":"string","enum":["tlp"]},"___created":{"type":"string","enum":["2017-01-20T00:00:00.000Z"]}}}],"$schema":"http:\/\/json-schema.org\/draft-07\/schema#","description":"The marking-definition object represents a specific marking.","title":"marking-definition","type":"object","definitions":{"_88tlp_green":{"description":"The marking-definition object representing Traffic Light Protocol (TLP) Green.","properties":{"___definition":{"type":"object","properties":{"___tlp":{"type":"string","enum":["green"]}}},"___id":{"type":"string","enum":["marking-definition--34098fce-860f-48ae-8e50-ebd3cc5e41da"]}}},"_88tlp_amber":{"description":"The marking-definition object representing Traffic Light Protocol (TLP) Amber.","properties":{"___definition":{"type":"object","properties":{"___tlp":{"type":"string","enum":["amber"]}}},"___id":{"type":"string","enum":["marking-definition--f88d31f6-486f-44da-b317-01333bde0b82"]}}},"_88tlp_white":{"description":"The marking-definition object representing Traffic Light Protocol (TLP) White.","properties":{"___definition":{"type":"object","properties":{"___tlp":{"type":"string","enum":["white"]}}},"___id":{"type":"string","enum":["marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"]}}},"_88statement":{"description":"The Statement marking type defines the representation of a textual marking statement (e.g., copyright, terms of use, etc.) in a definition","type":"object","properties":{"___statement":{"description":"A statement (e.g., copyright, terms of use) applied to the content marked by this marking definition.","type":"string"}},"required":["statement"]},"_88tlp_red":{"description":"The marking-definition object representing Traffic Light Protocol (TLP) Red.","properties":{"___definition":{"type":"object","properties":{"___tlp":{"type":"string","enum":["red"]}}},"___id":{"type":"string","enum":["marking-definition--5e57c739-391a-4eb3-b6be-7d15ca92d5ed"]}}}},"properties":{"___name":{"description":"A name used to identify the Marking Definition.","type":"string"},"___created_by_ref":{"$eref":{"$schema":"http:\/\/json-schema.org\/draft-07\/schema#","pattern":"^[a-z0-9][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$","description":"Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.","title":"identifier","type":"string","$id":"http:\/\/raw.githubusercontent.com\/oasis-open\/cti-stix2-json-schemas\/stix2.1\/schemas\/common\/identifier.json"},"description":"The created_by_ref property specifies the ID of the identity object that describes the entity that created this Marking Definition."},"___type":{"description":"The type of this object, which MUST be the literal `marking-definition`.","type":"string","enum":["marking-definition"]},"___granular_markings":{"minItems":1,"description":"The granular_markings property specifies a list of granular markings applied to this object.","type":"array","items":{"$eref":{"$schema":"http:\/\/json-schema.org\/draft-07\/schema#","description":"The granular-marking type defines how the list of marking-definition objects referenced by the marking_refs property to apply to a set of content identified by the list of selectors in the selectors property.","title":"granular-marking","type":"object","properties":{"___selectors":{"minItems":1,"description":"A list of selectors for content contained within the STIX object in which this property appears.","type":"array","items":{"pattern":"^[a-z0-9_-]{3,250}(\\.(\\[\\d+\\]|[a-z0-9_-]{1,250}))*$","type":"string"}},"___lang":{"description":"Identifies the language of the text identified by this marking.","type":"string"},"___marking_ref":{"allOf":[{"$ref":"..\/common\/identifier.json"},{"pattern":"^marking-definition--","description":"The marking_ref property specifies the ID of the marking-definition object that describes the marking."}]}},"required":["selectors","marking_ref"],"$id":"http:\/\/raw.githubusercontent.com\/oasis-open\/cti-stix2-json-schemas\/stix2.1\/schemas\/common\/granular-marking.json"}}},"___object_marking_refs":{"minItems":1,"description":"The object_marking_refs property specifies a list of IDs of marking-definition objects that apply to this Marking Definition.","type":"array","items":{"allOf":[{"$eref":{"$schema":"http:\/\/json-schema.org\/draft-07\/schema#","pattern":"^[a-z0-9][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$","description":"Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.","title":"identifier","type":"string","$id":"http:\/\/raw.githubusercontent.com\/oasis-open\/cti-stix2-json-schemas\/stix2.1\/schemas\/common\/identifier.json"}},{"pattern":"^marking-definition--"}]}},"___external_references":{"minItems":1,"description":"A list of external references which refers to non-STIX information.","type":"array","items":{"$eref":{"oneOf":[{"properties":{"___source_name":{"pattern":"^cve$","description":"The source within which the external-reference is defined (system, registry, organization, etc.)","type":"string"},"___external_id":{"pattern":"^CVE-\\d{4}-(0\\d{3}|[1-9]\\d{3,})$","description":"An identifier for the external reference content.","type":"string"}},"required":["source_name","external_id"]},{"properties":{"___source_name":{"pattern":"^capec$","description":"The source within which the external-reference is defined (system, registry, organization, etc.)","type":"string"},"___external_id":{"pattern":"^CAPEC-\\d+$","description":"An identifier for the external reference content.","type":"string"}},"required":["source_name","external_id"]},{"anyOf":[{"required":["external_id"]},{"required":["description"]},{"required":["url"]}],"properties":{"___source_name":{"not":{"pattern":"^((cve)|(capec))$"},"description":"The source within which the external-reference is defined (system, registry, organization, etc.)","type":"string"},"___external_id":{"not":{"pattern":"^((CVE-\\d{4}-(0\\d{3}|[1-9]\\d{3,}))|(CAPEC-\\d+))$"},"description":"An identifier for the external reference content.","type":"string"}},"required":["source_name"]}],"$schema":"http:\/\/json-schema.org\/draft-07\/schema#","description":"External references are used to describe pointers to information represented outside of STIX.","title":"external-reference","type":"object","properties":{"___description":{"description":"A human readable description","type":"string"},"___hashes":{"description":"Specifies a dictionary of hashes for the file.","$ref":"..\/common\/hashes-type.json"},"___url":{"description":"A URL reference to an external resource.","$ref":"..\/common\/url-regex.json"}},"$id":"http:\/\/raw.githubusercontent.com\/oasis-open\/cti-stix2-json-schemas\/stix2.1\/schemas\/common\/external-reference.json"}}},"___spec_version":{"description":"The version of the STIX specification used to represent this object.","type":"string","enum":["2.0","2.1"]},"___created":{"$eref":{"$schema":"http:\/\/json-schema.org\/draft-07\/schema#","pattern":"^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?Z$","description":"Represents timestamps across the CTI specifications. The format is an RFC3339 timestamp, with a required timezone specification of 'Z'.","title":"timestamp","type":"string","$id":"http:\/\/raw.githubusercontent.com\/oasis-open\/cti-stix2-json-schemas\/stix2.1\/schemas\/common\/timestamp.json"},"description":"The created property represents the time at which the first version of this Marking Definition object was created."}},"$id":"http:\/\/raw.githubusercontent.com\/oasis-open\/cti-stix2-json-schemas\/stix2.1\/schemas\/common\/marking-definition.json"}