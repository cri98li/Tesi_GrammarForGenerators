{"oneOf":[{"title":"Route rule","required":["route"]},{"title":"Action rule","required":["actions"]}],"additionalFields":false,"$schema":"http:\/\/json-schema.org\/draft-04\/schema#","title":"Rule","type":"object","definitions":{"_88delayAction":{"allOf":[{"$eref":{"description":"Action to apply to matching requests","title":"Action","type":"object","properties":{"___action":{"type":"string"}},"required":["action"]}}],"description":"Conditionally delay the request","additionalProperties":false,"title":"Delay","properties":{"___action":{"enum":["delay"]},"___tags":{"$eref":{"minItems":1,"uniqueItems":true,"description":"An array of one or more unique service tags.","title":"Tags","type":"array","items":{"type":"string"}}},"___probability":{"$eref":{"default":1,"description":"Probability of executing action","maximum":1,"exclusiveMinimum":true,"title":"Probability","type":"number","minimum":0}},"___duration":{"description":"Duration of delay in seconds","type":"number","exclusiveMinimum":true,"minimum":0}},"required":["duration"]},"_88uri":{"path":{"type":"string"},"prefix_rewrite":{"type":"string"},"prefix":{"type":"string"},"description":"Backend URI definition","title":"URI"},"_88headers":{"description":"Header key\/value pairs","additionalProperties":{"title":"Header","type":"string"},"title":"Headers","type":"object","minProperties":1},"_88action":{"description":"Action to apply to matching requests","title":"Action","type":"object","properties":{"___action":{"type":"string"}},"required":["action"]},"_88basicBackend":{"description":"Basic backend to route to","additionalProperties":false,"title":"Basic Backend","type":"object","properties":{"___name":{"description":"The service name","title":"Service name","type":"string"},"___tags":{"$eref":{"minItems":1,"uniqueItems":true,"description":"An array of one or more unique service tags.","title":"Tags","type":"array","items":{"type":"string"}}}},"required":["tags"]},"_88traceAction":{"allOf":[{"$eref":{"description":"Action to apply to matching requests","title":"Action","type":"object","properties":{"___action":{"type":"string"}},"required":["action"]}}],"description":"Trace request","additionalProperties":false,"title":"Trace","properties":{"___log_value":{"type":"string"},"___action":{"enum":["trace"]},"___tags":{"$eref":{"minItems":1,"uniqueItems":true,"description":"An array of one or more unique service tags.","title":"Tags","type":"array","items":{"type":"string"}}},"___log_key":{"default":"trace","type":"string"}}},"_88source":{"description":"Microservice where request originated from","additionalProperties":false,"title":"Source","type":"object","properties":{"___name":{"type":"string"},"___tags":{"$eref":{"minItems":1,"uniqueItems":true,"description":"An array of one or more unique service tags.","title":"Tags","type":"array","items":{"type":"string"}}}},"required":["name"]},"_88match":{"description":"Conditions that must be true to apply the action or routing","additionalProperties":false,"title":"Match","type":"object","properties":{"___headers":{"$eref":{"description":"Header key\/value pairs","additionalProperties":{"title":"Header","type":"string"},"title":"Headers","type":"object","minProperties":1}},"___source":{"$eref":{"description":"Microservice where request originated from","additionalProperties":false,"title":"Source","type":"object","properties":{"___name":{"type":"string"},"___tags":{"$ref":"#\/definitions\/tags"}},"required":["name"]}}},"minProperties":1},"_88probability":{"default":1,"description":"Probability of executing action","maximum":1,"exclusiveMinimum":true,"title":"Probability","type":"number","minimum":0},"_88tags":{"minItems":1,"uniqueItems":true,"description":"An array of one or more unique service tags.","title":"Tags","type":"array","items":{"type":"string"}},"_88abortAction":{"allOf":[{"$eref":{"description":"Action to apply to matching requests","title":"Action","type":"object","properties":{"___action":{"type":"string"}},"required":["action"]}}],"description":"Conditionally abort the request","additionalProperties":false,"title":"Abort","properties":{"___action":{"enum":["abort"]},"___tags":{"$eref":{"minItems":1,"uniqueItems":true,"description":"An array of one or more unique service tags.","title":"Tags","type":"array","items":{"type":"string"}}},"___return_code":{"description":"Return code","maximum":599,"type":"number","minimum":-5},"___probability":{"$eref":{"default":1,"description":"Probability of executing action","maximum":1,"exclusiveMinimum":true,"title":"Probability","type":"number","minimum":0}}},"required":["return_code"]},"_88route":{"additionalProperties":false,"type":"object","properties":{"___http_req_timeout":{"description":"Timeout for a HTTP request. Includes retries as well. Unit is in floating point seconds. Default 15.0s","type":"number","exclusiveMinimum":true,"minimum":0},"___backends":{"minItems":1,"type":"array","items":{"$eref":{"description":"Backend to route to","additionalProperties":false,"title":"Backend","type":"object","properties":{"___name":{"description":"The service name","title":"Service name","type":"string"},"___weight":{"default":1,"description":"Percentage of traffic to route to this backend.","maximum":1,"exclusiveMinimum":true,"title":"Traffic weight","type":"number","minimum":0},"___tags":{"$ref":"#\/definitions\/tags"},"___resilience":{"additionalProperties":false,"type":"object","properties":{"___max_requests":{"description":"Maximum number of requests to a backend.  Defaults to 1024","type":"integer","exclusiveMinimum":false,"minimum":0},"___max_requests_per_connection":{"description":"Maximum number of requests per connection to an backend.","type":"integer","exclusiveMinimum":false,"minimum":0},"___detection_interval":{"description":"Interval for checking state of hystrix circuit.  Defaults to 10s.","type":"number","exclusiveMinimum":false,"minimum":0},"___max_pending_requests":{"description":"Maximum number of pending requests to a backend.  Defaults to 1024.","type":"integer","exclusiveMinimum":false,"minimum":0},"___sleep_window":{"description":"Minimum time the circuit will be closed.  Defaults to 30s","type":"number","exclusiveMinimum":false,"minimum":0},"___max_connections":{"description":"Maximum number of connections to a backend.  Defaults to 1024.","type":"integer","exclusiveMinimum":false,"minimum":0},"___consecutive_errors":{"description":"Number of 5XX errors before circuit is opened.  Defaults to 5","type":"integer","exclusiveMinimum":false,"minimum":0}}},"___lb_type":{"enum":["round_robin","least_request","random"]}},"required":["tags"]}}},"___uri":{"$eref":{"path":{"type":"string"},"prefix_rewrite":{"type":"string"},"prefix":{"type":"string"},"description":"Backend URI definition","title":"URI"}},"___http_req_retries":{"description":"Number of retries for a given request. The interval between retries will be determined automatically (25ms+). Actual number of retries attempted depends on the http_req_timeout","type":"integer","exclusiveMinimum":false,"minimum":0}},"required":["backends"]},"_88backend":{"description":"Backend to route to","additionalProperties":false,"title":"Backend","type":"object","properties":{"___name":{"description":"The service name","title":"Service name","type":"string"},"___weight":{"default":1,"description":"Percentage of traffic to route to this backend.","maximum":1,"exclusiveMinimum":true,"title":"Traffic weight","type":"number","minimum":0},"___tags":{"$eref":{"minItems":1,"uniqueItems":true,"description":"An array of one or more unique service tags.","title":"Tags","type":"array","items":{"type":"string"}}},"___resilience":{"additionalProperties":false,"type":"object","properties":{"___max_requests":{"description":"Maximum number of requests to a backend.  Defaults to 1024","type":"integer","exclusiveMinimum":false,"minimum":0},"___max_requests_per_connection":{"description":"Maximum number of requests per connection to an backend.","type":"integer","exclusiveMinimum":false,"minimum":0},"___detection_interval":{"description":"Interval for checking state of hystrix circuit.  Defaults to 10s.","type":"number","exclusiveMinimum":false,"minimum":0},"___max_pending_requests":{"description":"Maximum number of pending requests to a backend.  Defaults to 1024.","type":"integer","exclusiveMinimum":false,"minimum":0},"___sleep_window":{"description":"Minimum time the circuit will be closed.  Defaults to 30s","type":"number","exclusiveMinimum":false,"minimum":0},"___max_connections":{"description":"Maximum number of connections to a backend.  Defaults to 1024.","type":"integer","exclusiveMinimum":false,"minimum":0},"___consecutive_errors":{"description":"Number of 5XX errors before circuit is opened.  Defaults to 5","type":"integer","exclusiveMinimum":false,"minimum":0}}},"___lb_type":{"enum":["round_robin","least_request","random"]}},"required":["tags"]}},"properties":{"___destination":{"type":"string"},"___tags":{"type":"array","items":{"type":"string"}},"___actions":{"minItems":1,"type":"array","items":{"anyOf":[{"$eref":{"allOf":[{"$ref":"#\/definitions\/action"}],"description":"Conditionally delay the request","additionalProperties":false,"title":"Delay","properties":{"___action":{"enum":["delay"]},"___tags":{"$ref":"#\/definitions\/tags"},"___probability":{"$ref":"#\/definitions\/probability"},"___duration":{"description":"Duration of delay in seconds","type":"number","exclusiveMinimum":true,"minimum":0}},"required":["duration"]}},{"$eref":{"allOf":[{"$ref":"#\/definitions\/action"}],"description":"Conditionally abort the request","additionalProperties":false,"title":"Abort","properties":{"___action":{"enum":["abort"]},"___tags":{"$ref":"#\/definitions\/tags"},"___return_code":{"description":"Return code","maximum":599,"type":"number","minimum":-5},"___probability":{"$ref":"#\/definitions\/probability"}},"required":["return_code"]}},{"$eref":{"allOf":[{"$ref":"#\/definitions\/action"}],"description":"Trace request","additionalProperties":false,"title":"Trace","properties":{"___log_value":{"type":"string"},"___action":{"enum":["trace"]},"___tags":{"$ref":"#\/definitions\/tags"},"___log_key":{"default":"trace","type":"string"}}}}]}},"___route":{"$eref":{"additionalProperties":false,"type":"object","properties":{"___http_req_timeout":{"description":"Timeout for a HTTP request. Includes retries as well. Unit is in floating point seconds. Default 15.0s","type":"number","exclusiveMinimum":true,"minimum":0},"___backends":{"minItems":1,"type":"array","items":{"$ref":"#\/definitions\/backend"}},"___uri":{"$ref":"#\/definitions\/uri"},"___http_req_retries":{"description":"Number of retries for a given request. The interval between retries will be determined automatically (25ms+). Actual number of retries attempted depends on the http_req_timeout","type":"integer","exclusiveMinimum":false,"minimum":0}},"required":["backends"]}},"___id":{"type":"string"},"___priority":{"default":0,"type":"number"},"___match":{"$eref":{"description":"Conditions that must be true to apply the action or routing","additionalProperties":false,"title":"Match","type":"object","properties":{"___headers":{"$ref":"#\/definitions\/headers"},"___source":{"$ref":"#\/definitions\/source"}},"minProperties":1}}},"required":["destination"]}