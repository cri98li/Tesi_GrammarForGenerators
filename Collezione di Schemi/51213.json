{"allOf":[{"$eref":{"patternProperties":{"___^[a-z0-9_]{3,250}$":{"anyOf":[{"minItems":1,"type":"array"},{"type":"string"},{"type":"integer"},{"type":"boolean"},{"type":"number"},{"type":"object"}]}},"not":{"anyOf":[{"required":["action"]}]},"$schema":"http:\/\/json-schema.org\/draft-04\/schema#","description":"Common properties and behavior across all Cyber Observable Objects.","additionalProperties":false,"title":"core","type":"object","properties":{"___description":{"description":"Specifies a textual description of the Object.","type":"string"},"___extensions":{"description":"Specifies any extensions of the object, as a dictionary.","$ref":"..\/common\/dictionary.json"},"___type":{"not":{"enum":["action"]},"minLength":3,"pattern":"^\\-?[a-z0-9]+(-[a-z0-9]+)*\\-?$","description":"Indicates that this object is an Observable Object. The value of this property MUST be a valid Observable Object type name, but to allow for custom objects this has been removed from the schema.","type":"string","maxLength":250}},"required":["type"]}},{"properties":{"___content_type":{"description":"Specifies the value of the 'Content-Type' header of the email message.","type":"string"},"___from_ref":{"description":"Specifies the value of the 'From:' header of the email message.","type":"string"},"___type":{"description":"The value of this property MUST be `email-message`.","type":"string","enum":["email-message"]},"___raw_email_ref":{"description":"Specifies the raw binary contents of the email message, including both the headers and body, as a reference to an Artifact Object.","type":"string"},"___additional_header_fields":{"$eref":{"patternProperties":{"___^[a-zA-Z0-9_-]{3,256}$":{"oneOf":[{"minItems":2,"type":"array","items":{"type":"string"}},{"type":"string"}]}},"not":{"patternProperties":{"___^date|received_lines|content_type|from_ref|sender_ref|to_refs|cc_refs|bcc_refs|subject$":{"description":"Invalid additional header field types"}},"additionalProperties":false},"description":"Specifies any other header fields (except for date, received_lines, content_type, from_ref, sender_ref, to_refs, cc_refs, bcc_refs, and subject) found in the email message, as a dictionary.","type":"object"},"description":"Specifies any other header fields found in the email message, as a dictionary."},"___to_refs":{"description":"Specifies the mailboxes that are 'To:' recipients of the email message","type":"array","items":{"type":"string"}},"___received_lines":{"description":"Specifies one or more Received header fields that may be included in the email headers.","type":"array","items":{"type":"string"}},"___date":{"$eref":{"$schema":"http:\/\/json-schema.org\/draft-04\/schema#","pattern":"^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]+)?Z$","description":"Represents timestamps across the CTI specifications. The format is an RFC3339 timestamp, with a required timezone specification of 'Z'.","title":"timestamp","type":"string"},"description":"Specifies the date\/time that the email message was sent."},"___sender_ref":{"description":"Specifies the value of the 'From' field of the email message","type":"string"},"___bcc_refs":{"description":"Specifies the mailboxes that are 'BCC:' recipients of the email message.","type":"array","items":{"type":"string"}},"___subject":{"description":"Specifies the subject of the email message.","type":"string"},"___cc_refs":{"description":"Specifies the mailboxes that are 'CC:' recipients of the email message","type":"array","items":{"type":"string"}}}}],"oneOf":[{"not":{"required":["body_multipart"]},"properties":{"___body":{"description":"Specifies a string containing the email body. This field MAY only be used if is_multipart is false.","type":"string"},"___is_multipart":{"description":"Indicates whether the email body contains multiple MIME parts.","type":"boolean","enum":[false]}},"required":["is_multipart"]},{"not":{"required":["body"]},"properties":{"___body_multipart":{"description":"Specifies a list of the MIME parts that make up the email body. This property MAY only be used if is_multipart is true.","type":"array","items":{"$eref":{"oneOf":[{"required":["body"]},{"required":["body_raw_ref"]}],"description":"Specifies a component of a multi-part email body.","type":"object","properties":{"___content_type":{"description":"Specifies the value of the 'Content-Type' header field of the MIME part.","type":"string"},"___body":{"description":"Specifies the contents of the MIME part if the content_type is not provided OR starts with text\/","type":"string"},"___content_disposition":{"description":"Specifies the value of the 'Content-Disposition' header field of the MIME part.","type":"string"},"___body_raw_ref":{"description":"Specifies the contents of non-textual MIME parts, that is those whose content_type does not start with text\/, as a reference to an Artifact Object or File Object.","type":"string"}}}}},"___is_multipart":{"description":"Indicates whether the email body contains multiple MIME parts.","type":"boolean","enum":[true]}},"required":["is_multipart"]}],"$schema":"http:\/\/json-schema.org\/draft-04\/schema#","description":"The Email Message Object represents an instance of an email message.","title":"email-message","type":"object","definitions":{"_88email-additional-header-fields":{"patternProperties":{"___^[a-zA-Z0-9_-]{3,256}$":{"oneOf":[{"minItems":2,"type":"array","items":{"type":"string"}},{"type":"string"}]}},"not":{"patternProperties":{"___^date|received_lines|content_type|from_ref|sender_ref|to_refs|cc_refs|bcc_refs|subject$":{"description":"Invalid additional header field types"}},"additionalProperties":false},"description":"Specifies any other header fields (except for date, received_lines, content_type, from_ref, sender_ref, to_refs, cc_refs, bcc_refs, and subject) found in the email message, as a dictionary.","type":"object"},"_88mime-part-type":{"oneOf":[{"required":["body"]},{"required":["body_raw_ref"]}],"description":"Specifies a component of a multi-part email body.","type":"object","properties":{"___content_type":{"description":"Specifies the value of the 'Content-Type' header field of the MIME part.","type":"string"},"___body":{"description":"Specifies the contents of the MIME part if the content_type is not provided OR starts with text\/","type":"string"},"___content_disposition":{"description":"Specifies the value of the 'Content-Disposition' header field of the MIME part.","type":"string"},"___body_raw_ref":{"description":"Specifies the contents of non-textual MIME parts, that is those whose content_type does not start with text\/, as a reference to an Artifact Object or File Object.","type":"string"}}}}}