{"allOf":[{"$eref":{"patternProperties":{"___^[a-z0-9_]{3,250}$":{"anyOf":[{"minItems":1,"type":"array"},{"type":"string"},{"type":"integer"},{"type":"boolean"},{"type":"number"},{"type":"object"}]}},"not":{"anyOf":[{"required":["severity"]},{"required":["action"]},{"required":["usernames"]},{"required":["phone_numbers"]}]},"$schema":"http:\/\/json-schema.org\/draft-07\/schema#","description":"Common properties and behavior across all STIX Domain Objects and STIX Relationship Objects.","additionalProperties":false,"title":"core","type":"object","properties":{"___type":{"not":{"enum":["incident","action"]},"minLength":3,"pattern":"^\\-?[a-zA-Z0-9]+(-[a-zA-Z0-9]+)*\\-?$","description":"The type property identifies the type of STIX Object (SDO, Relationship Object, etc). The value of the type field MUST be one of the types defined by a STIX Object (e.g., indicator).","title":"type","type":"string","maxLength":250},"___granular_markings":{"minItems":1,"description":"The set of granular markings that apply to this object.","type":"array","items":{"$ref":"..\/common\/granular-marking.json"}},"___external_references":{"minItems":1,"description":"A list of external references which refers to non-STIX information.","type":"array","items":{"$ref":"..\/common\/external-reference.json"}},"___labels":{"minItems":1,"description":"The labels property specifies a set of terms used to describe this object.","type":"array","items":{"type":"string"}},"___created":{"allOf":[{"$ref":"..\/common\/timestamp.json"},{"pattern":"T\\d{2}:\\d{2}:\\d{2}\\.\\d{3}Z$","title":"timestamp_millis"}],"description":"The created property represents the time at which the first version of this object was created. The timstamp value MUST be precise to the nearest millisecond."},"___created_by_ref":{"description":"The ID of the Source object that describes who created this object.","$ref":"..\/common\/identifier.json"},"___lang":{"description":"Identifies the language of the text content in this object.","type":"string"},"___object_marking_refs":{"minItems":1,"description":"The list of marking-definition objects to be applied to this object.","type":"array","items":{"$ref":"..\/common\/identifier.json"}},"___revoked":{"description":"The revoked property indicates whether the object has been revoked.","type":"boolean"},"___spec_version":{"description":"The version of the STIX specification used to represent this object.","type":"string","enum":["2.0","2.1"]},"___modified":{"allOf":[{"$ref":"..\/common\/timestamp.json"},{"pattern":"T\\d{2}:\\d{2}:\\d{2}\\.\\d{3}Z$","title":"timestamp_millis"}],"description":"The modified property represents the time that this particular version of the object was modified. The timstamp value MUST be precise to the nearest millisecond."},"___id":{"description":"The id property universally and uniquely identifies this object.","$ref":"..\/common\/identifier.json"},"___confidence":{"maximum":100,"description":"Identifies the confidence that the creator has in the correctness of their data.","type":"integer","minimum":0}},"required":["type","spec_version","id","created","modified"],"$id":"http:\/\/raw.githubusercontent.com\/oasis-open\/cti-stix2-json-schemas\/stix2.1\/schemas\/common\/core.json"}},{"properties":{"___type":{"description":"The type of this object, which MUST be the literal `malware-analysis`.","type":"string","enum":["malware-analysis"]},"___analysis_sco_refs":{"minItems":1,"description":"The list of STIX objects that were captured during the analysis process.","type":"array","items":{"$eref":{"$schema":"http:\/\/json-schema.org\/draft-07\/schema#","pattern":"^[a-z0-9][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$","description":"Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.","title":"identifier","type":"string","$id":"http:\/\/raw.githubusercontent.com\/oasis-open\/cti-stix2-json-schemas\/stix2.1\/schemas\/common\/identifier.json"}}},"___analysis_engine_version":{"description":"The version of the analysis engine or product that was used to perform this analysis.","type":"string"},"___analysis_ended":{"$eref":{"$schema":"http:\/\/json-schema.org\/draft-07\/schema#","pattern":"^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?Z$","description":"Represents timestamps across the CTI specifications. The format is an RFC3339 timestamp, with a required timezone specification of 'Z'.","title":"timestamp","type":"string","$id":"http:\/\/raw.githubusercontent.com\/oasis-open\/cti-stix2-json-schemas\/stix2.1\/schemas\/common\/timestamp.json"},"description":"The date and time that the malware analysis ended."},"___submitted":{"$eref":{"$schema":"http:\/\/json-schema.org\/draft-07\/schema#","pattern":"^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?Z$","description":"Represents timestamps across the CTI specifications. The format is an RFC3339 timestamp, with a required timezone specification of 'Z'.","title":"timestamp","type":"string","$id":"http:\/\/raw.githubusercontent.com\/oasis-open\/cti-stix2-json-schemas\/stix2.1\/schemas\/common\/timestamp.json"},"description":"The date and time that this malware was first submitted for scanning or analysis."},"___av_result":{"description":"The classification result or name assigned to the malware instance by the AV scanner tool.","type":"string"},"___analysis_definition_version":{"description":"The version of the analysis definitions used by the analysis tool.","type":"string"},"___analysis_started":{"$eref":{"$schema":"http:\/\/json-schema.org\/draft-07\/schema#","pattern":"^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?Z$","description":"Represents timestamps across the CTI specifications. The format is an RFC3339 timestamp, with a required timezone specification of 'Z'.","title":"timestamp","type":"string","$id":"http:\/\/raw.githubusercontent.com\/oasis-open\/cti-stix2-json-schemas\/stix2.1\/schemas\/common\/timestamp.json"},"description":"The date and time that the malware analysis was initiated."},"___configuration_version":{"description":"The version of the analysis product configuration that was used to perform this analysis.","type":"string"},"___product":{"description":"The name of the analysis engine or product that was used for this analysis.","type":"string"},"___version":{"description":"The version of the analysis product that was used to perform this analysis.","type":"string"},"___modules":{"minItems":1,"description":"The particular analysis product modules that were used to perform the analysis.","type":"array","items":{"type":"string"}},"___operating_system_ref":{"allOf":[{"$eref":{"$schema":"http:\/\/json-schema.org\/draft-07\/schema#","pattern":"^[a-z0-9][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$","description":"Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.","title":"identifier","type":"string","$id":"http:\/\/raw.githubusercontent.com\/oasis-open\/cti-stix2-json-schemas\/stix2.1\/schemas\/common\/identifier.json"}},{"pattern":"^software--"}],"description":"The operating system that was used to perform the dynamic analysis."},"___host_vm_ref":{"allOf":[{"$eref":{"$schema":"http:\/\/json-schema.org\/draft-07\/schema#","pattern":"^[a-z0-9][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$","description":"Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.","title":"identifier","type":"string","$id":"http:\/\/raw.githubusercontent.com\/oasis-open\/cti-stix2-json-schemas\/stix2.1\/schemas\/common\/identifier.json"}},{"pattern":"^software--"}],"description":"A description of the virtual machine environment used to host the guest operating system (if applicable) that was used for the dynamic analysis of the malware instance or family."},"___installed_software_refs":{"minItems":1,"description":"Any non-standard software installed on the operating system used for the dynamic analysis of the malware instance or family.","type":"array","items":{"allOf":[{"$eref":{"$schema":"http:\/\/json-schema.org\/draft-07\/schema#","pattern":"^[a-z0-9][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$","description":"Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.","title":"identifier","type":"string","$id":"http:\/\/raw.githubusercontent.com\/oasis-open\/cti-stix2-json-schemas\/stix2.1\/schemas\/common\/identifier.json"}},{"pattern":"^software--"}]}},"___id":{"pattern":"^malware-analysis--","title":"id"}}}],"oneOf":[{"required":["av_result"]},{"required":["analysis_sco_refs"]}],"$schema":"http:\/\/json-schema.org\/draft-07\/schema#","description":"Malware Analysis captures the metadata and results of a particular analysis performed (static or dynamic) on the malware instance or family.","title":"malware-analysis","type":"object","definitions":{"_88malware-av-result-ov":{"type":"string","enum":["malicious","suspicious","benign","unknown"]}},"required":["product"],"$id":"http:\/\/raw.githubusercontent.com\/oasis-open\/cti-stix2-json-schemas\/stix2.1\/schemas\/sdos\/malware-analysis.json"}