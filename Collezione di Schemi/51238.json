{"allOf":[{"$eref":{"patternProperties":{"___^[a-z0-9_]{3,250}$":{"anyOf":[{"minItems":1,"type":"array"},{"type":"string"},{"type":"integer"},{"type":"boolean"},{"type":"number"},{"type":"object"}]}},"not":{"anyOf":[{"required":["action"]}]},"$schema":"http:\/\/json-schema.org\/draft-04\/schema#","description":"Common properties and behavior across all Cyber Observable Objects.","additionalProperties":false,"title":"core","type":"object","properties":{"___description":{"description":"Specifies a textual description of the Object.","type":"string"},"___extensions":{"description":"Specifies any extensions of the object, as a dictionary.","$ref":"..\/common\/dictionary.json"},"___type":{"not":{"enum":["action"]},"minLength":3,"pattern":"^\\-?[a-z0-9]+(-[a-z0-9]+)*\\-?$","description":"Indicates that this object is an Observable Object. The value of this property MUST be a valid Observable Object type name, but to allow for custom objects this has been removed from the schema.","type":"string","maxLength":250}},"required":["type"]}},{"properties":{"___extensions":{"$eref":{"anyOf":[{"patternProperties":{"___^http-request-ext$":{"description":"The HTTP request extension specifies a default extension for capturing network traffic properties specific to HTTP requests.","type":"object","properties":{"___request_version":{"description":"Specifies the HTTP version portion of the HTTP request line, as a lowercase string.","type":"string"},"___request_method":{"description":"Specifies the HTTP method portion of the HTTP request line, as a lowercase string.","type":"string"},"___request_value":{"description":"Specifies the value (typically a resource path) portion of the HTTP request line.","type":"string"},"___message_body_length":{"description":"Specifies the length of the HTTP message body, if included, in bytes.","type":"integer"},"___message_body_data_ref":{"description":"Specifies the data contained in the HTTP message body, if included.","type":"string"},"___request_header":{"patternProperties":{"___^Accept|Accept-Charset|Accept-Encoding|Accept-Language|Accept-Datetime|Authorization|Cache-Control|Connection|Cookie|Content-Length|Content-MD5|Content-Type|Date|Expect|Forwarded|From|Host|If-Match|If-Modified-Since|If-None-Match|If-Range|If-Unmodified-Since|Max-Forwards|Origin|Pragma|Proxy-Authorization|Range|Referer|TE|User-Agent|Upgrade|Via|Warning$":{"type":"string"}},"description":"Specifies all of the HTTP header fields that may be found in the HTTP client request, as a dictionary.","additionalProperties":false,"type":"object"}},"required":["request_method","request_value"]}}},{"patternProperties":{"___^icmp-ext$":{"description":"The ICMP extension specifies a default extension for capturing network traffic properties specific to ICMP.","type":"object","properties":{"___icmp_type_hex":{"description":"Specifies the ICMP type byte.","$ref":"..\/common\/hex.json"},"___icmp_code_hex":{"description":"Specifies the ICMP code byte.","$ref":"..\/common\/hex.json"}},"required":["icmp_type_hex","icmp_code_hex"]}}},{"patternProperties":{"___^socket-ext$":{"description":"The Network Socket extension specifies a default extension for capturing network traffic properties associated with network sockets.","type":"object","properties":{"___options":{"description":"Specifies any options (SO_*) that may be used by the socket, as a dictionary.","$ref":"..\/common\/dictionary.json"},"___is_blocking":{"description":"Specifies whether the socket is in blocking mode.","type":"boolean"},"___socket_descriptor":{"description":"Specifies the socket file descriptor value associated with the socket, as a non-negative integer.","type":"integer"},"___socket_handle":{"description":"Specifies the handle or inode value associated with the socket.","type":"integer"},"___is_listening":{"description":"Specifies whether the socket is in listening mode.","type":"boolean"},"___socket_type":{"description":"Specifies the type of the socket.","type":"string","enum":["SOCK_STREAM","SOCK_DGRAM","SOCK_RAW","SOCK_RDM","SOCK_SEQPACKET"]},"___address_family":{"description":"Specifies the address family (AF_*) that the socket is configured for.","type":"string","enum":["AF_UNSPEC","AF_INET","AF_IPX","AF_APPLETALK","AF_NETBIOS","AF_INET6","AF_IRDA","AF_BTH"]},"___protocol_family":{"description":"Specifies the protocol family (PF_*) that the socket is configured for.","type":"string","enum":["PF_INET","PF_AX25","PF_IPX","PF_INET6","PF_APPLETALK","PF_NETROM","PF_BRIDGE","PF_ATMPVC","PF_X25","PF_ROSE","PF_DECNET","PF_NETBEUI","PF_SECURITY","PF_KEY","PF_NETLINK","PF_ROUTE","PF_PACKET","PF_ASH","PF_ECONET","PF_ATMSVC","PF_SNA","PF_IRDA","PF_PPPOX","PF_WANPIPE","PF_BLUETOOTH"]}},"required":["address_family"]}}},{"patternProperties":{"___^tcp-ext$":{"description":"The TCP extension specifies a default extension for capturing network traffic properties specific to TCP.","type":"object","properties":{"___src_flags_hex":{"description":"Specifies the source TCP flags, as the union of all TCP flags observed between the start of the traffic (as defined by the start property) and the end of the traffic (as defined by the end property). ","$ref":"..\/common\/hex.json"},"___dst_flags_hex":{"description":"Specifies the destination TCP flags, as the union of all TCP flags observed between the start of the traffic (as defined by the start property) and the end of the traffic (as defined by the end property).","$ref":"..\/common\/hex.json"}}}}},{"not":{"patternProperties":{"___^http-ext|icmp-ext|tcp-ext|socket-ext$":{"description":"Invalid custom file extension"}}}}],"additionalProperties":{"description":"Custom file extension","$ref":"..\/common\/dictionary.json"},"type":"object"},"description":"The Network Traffic Object defines the following extensions. In addition to these, producers MAY create their own. Extensions: http-ext, tcp-ext, icmp-ext, socket-ext"},"___type":{"description":"The value of this property MUST be `network-traffic`.","type":"string","enum":["network-traffic"]},"___start":{"$eref":{"$schema":"http:\/\/json-schema.org\/draft-04\/schema#","pattern":"^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]+)?Z$","description":"Represents timestamps across the CTI specifications. The format is an RFC3339 timestamp, with a required timezone specification of 'Z'.","title":"timestamp","type":"string"},"description":"Specifies the date\/time the network traffic was initiated, if known."},"___encapsulates_refs":{"description":"Links to other network-traffic objects encapsulated by a network-traffic.","type":"array","items":{"type":"string"}},"___src_packets":{"description":"Specifies the number of packets sent from the source to the destination.","type":"integer"},"___src_byte_count":{"description":"Specifies the number of bytes sent from the source to the destination.","type":"integer"},"___src_port":{"description":"Specifies the source port used in the network traffic, as an integer. The port value MUST be in the range of 0 - 65535.","maximum":65535,"type":"integer","minimum":0},"___dst_ref":{"description":"Specifies the destination of the network traffic, as a reference to one or more Observable Objects.","type":"string"},"___protocols":{"minItems":1,"description":"Specifies the protocols observed in the network traffic, along with their corresponding state.","type":"array","items":{"type":"string"}},"___encapsulated_by_ref":{"description":"Links to another network-traffic object which encapsulates this object.","type":"string"},"___dst_port":{"description":"Specifies the destination port used in the network traffic, as an integer. The port value MUST be in the range of 0 - 65535.","maximum":65535,"type":"integer","minimum":0},"___src_ref":{"description":"Specifies the source of the network traffic, as a reference to one or more Observable Objects.","type":"string"},"___src_payload_ref":{"description":"Specifies the bytes sent from the source to the destination.","type":"string"},"___dst_packets":{"description":"Specifies the number of packets sent destination to the source.","type":"integer"},"___ipfix":{"patternProperties":{"___^[a-zA-Z0-9_-]{3,256}$":{"anyOf":[{"type":"string"},{"type":"integer"}]}},"type":"object"},"___dst_payload_ref":{"description":"Specifies the bytes sent from the source to the destination.","type":"string"},"___dst_byte_count":{"description":"Specifies the number of bytes sent from the destination to the source.","type":"integer"},"___end":{"$eref":{"$schema":"http:\/\/json-schema.org\/draft-04\/schema#","pattern":"^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]+)?Z$","description":"Represents timestamps across the CTI specifications. The format is an RFC3339 timestamp, with a required timezone specification of 'Z'.","title":"timestamp","type":"string"},"description":"Specifies the date\/time the network traffic ended, if known."}}}],"oneOf":[{"properties":{"___is_active":{"description":"Indicates whether the network traffic is still ongoing.","type":"boolean","enum":[false]}},"required":["is_active"]},{"not":{"required":["end"]},"properties":{"___is_active":{"description":"Indicates whether the network traffic is still ongoing.","type":"boolean","enum":[true]}},"required":["is_active"]},{"not":{"required":["is_active"]}}],"$schema":"http:\/\/json-schema.org\/draft-04\/schema#","description":"The Network Traffic Object represents arbitrary network traffic that originates from a source and is addressed to a destination.","anyOf":[{"required":["src_ref"]},{"required":["dst_ref"]}],"title":"network-traffic","type":"object","definitions":{"_88network-traffic-extensions-dictionary":{"anyOf":[{"patternProperties":{"___^http-request-ext$":{"description":"The HTTP request extension specifies a default extension for capturing network traffic properties specific to HTTP requests.","type":"object","properties":{"___request_version":{"description":"Specifies the HTTP version portion of the HTTP request line, as a lowercase string.","type":"string"},"___request_method":{"description":"Specifies the HTTP method portion of the HTTP request line, as a lowercase string.","type":"string"},"___request_value":{"description":"Specifies the value (typically a resource path) portion of the HTTP request line.","type":"string"},"___message_body_length":{"description":"Specifies the length of the HTTP message body, if included, in bytes.","type":"integer"},"___message_body_data_ref":{"description":"Specifies the data contained in the HTTP message body, if included.","type":"string"},"___request_header":{"patternProperties":{"___^Accept|Accept-Charset|Accept-Encoding|Accept-Language|Accept-Datetime|Authorization|Cache-Control|Connection|Cookie|Content-Length|Content-MD5|Content-Type|Date|Expect|Forwarded|From|Host|If-Match|If-Modified-Since|If-None-Match|If-Range|If-Unmodified-Since|Max-Forwards|Origin|Pragma|Proxy-Authorization|Range|Referer|TE|User-Agent|Upgrade|Via|Warning$":{"type":"string"}},"description":"Specifies all of the HTTP header fields that may be found in the HTTP client request, as a dictionary.","additionalProperties":false,"type":"object"}},"required":["request_method","request_value"]}}},{"patternProperties":{"___^icmp-ext$":{"description":"The ICMP extension specifies a default extension for capturing network traffic properties specific to ICMP.","type":"object","properties":{"___icmp_type_hex":{"$eref":{"$schema":"http:\/\/json-schema.org\/draft-04\/schema#","pattern":"^([a-fA-F0-9]{2})+$","description":"The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.","title":"hex","type":"string"},"description":"Specifies the ICMP type byte."},"___icmp_code_hex":{"$eref":{"$schema":"http:\/\/json-schema.org\/draft-04\/schema#","pattern":"^([a-fA-F0-9]{2})+$","description":"The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.","title":"hex","type":"string"},"description":"Specifies the ICMP code byte."}},"required":["icmp_type_hex","icmp_code_hex"]}}},{"patternProperties":{"___^socket-ext$":{"description":"The Network Socket extension specifies a default extension for capturing network traffic properties associated with network sockets.","type":"object","properties":{"___options":{"$eref":{"patternProperties":{"___^[a-zA-Z0-9_-]{3,256}$":{"anyOf":[{"minItems":1,"type":"array"},{"type":"string"},{"type":"integer"},{"type":"boolean"},{"type":"number"},{"type":"object"}]}},"$schema":"http:\/\/json-schema.org\/draft-04\/schema#","description":"A dictionary captures a set of key\/value pairs","additionalProperties":false,"title":"dictionary","type":"object"},"description":"Specifies any options (SO_*) that may be used by the socket, as a dictionary."},"___is_blocking":{"description":"Specifies whether the socket is in blocking mode.","type":"boolean"},"___socket_descriptor":{"description":"Specifies the socket file descriptor value associated with the socket, as a non-negative integer.","type":"integer"},"___socket_handle":{"description":"Specifies the handle or inode value associated with the socket.","type":"integer"},"___is_listening":{"description":"Specifies whether the socket is in listening mode.","type":"boolean"},"___socket_type":{"description":"Specifies the type of the socket.","type":"string","enum":["SOCK_STREAM","SOCK_DGRAM","SOCK_RAW","SOCK_RDM","SOCK_SEQPACKET"]},"___address_family":{"description":"Specifies the address family (AF_*) that the socket is configured for.","type":"string","enum":["AF_UNSPEC","AF_INET","AF_IPX","AF_APPLETALK","AF_NETBIOS","AF_INET6","AF_IRDA","AF_BTH"]},"___protocol_family":{"description":"Specifies the protocol family (PF_*) that the socket is configured for.","type":"string","enum":["PF_INET","PF_AX25","PF_IPX","PF_INET6","PF_APPLETALK","PF_NETROM","PF_BRIDGE","PF_ATMPVC","PF_X25","PF_ROSE","PF_DECNET","PF_NETBEUI","PF_SECURITY","PF_KEY","PF_NETLINK","PF_ROUTE","PF_PACKET","PF_ASH","PF_ECONET","PF_ATMSVC","PF_SNA","PF_IRDA","PF_PPPOX","PF_WANPIPE","PF_BLUETOOTH"]}},"required":["address_family"]}}},{"patternProperties":{"___^tcp-ext$":{"description":"The TCP extension specifies a default extension for capturing network traffic properties specific to TCP.","type":"object","properties":{"___src_flags_hex":{"$eref":{"$schema":"http:\/\/json-schema.org\/draft-04\/schema#","pattern":"^([a-fA-F0-9]{2})+$","description":"The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.","title":"hex","type":"string"},"description":"Specifies the source TCP flags, as the union of all TCP flags observed between the start of the traffic (as defined by the start property) and the end of the traffic (as defined by the end property). "},"___dst_flags_hex":{"$eref":{"$schema":"http:\/\/json-schema.org\/draft-04\/schema#","pattern":"^([a-fA-F0-9]{2})+$","description":"The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.","title":"hex","type":"string"},"description":"Specifies the destination TCP flags, as the union of all TCP flags observed between the start of the traffic (as defined by the start property) and the end of the traffic (as defined by the end property)."}}}}},{"not":{"patternProperties":{"___^http-ext|icmp-ext|tcp-ext|socket-ext$":{"description":"Invalid custom file extension"}}}}],"additionalProperties":{"$eref":{"patternProperties":{"___^[a-zA-Z0-9_-]{3,256}$":{"anyOf":[{"minItems":1,"type":"array"},{"type":"string"},{"type":"integer"},{"type":"boolean"},{"type":"number"},{"type":"object"}]}},"$schema":"http:\/\/json-schema.org\/draft-04\/schema#","description":"A dictionary captures a set of key\/value pairs","additionalProperties":false,"title":"dictionary","type":"object"},"description":"Custom file extension"},"type":"object"}},"required":["protocols"]}