{"oneOf":[{"properties":{"___source_name":{"pattern":"^cve$","description":"The source within which the external-reference is defined (system, registry, organization, etc.)","type":"string"},"___external_id":{"pattern":"^CVE-\\d{4}-(0\\d{3}|[1-9]\\d{3,})$","description":"An identifier for the external reference content.","type":"string"}},"required":["source_name","external_id"]},{"properties":{"___source_name":{"pattern":"^capec$","description":"The source within which the external-reference is defined (system, registry, organization, etc.)","type":"string"},"___external_id":{"pattern":"^CAPEC-\\d+$","description":"An identifier for the external reference content.","type":"string"}},"required":["source_name","external_id"]},{"anyOf":[{"required":["external_id"]},{"required":["description"]},{"required":["url"]}],"properties":{"___source_name":{"not":{"pattern":"^((cve)|(capec))$"},"description":"The source within which the external-reference is defined (system, registry, organization, etc.)","type":"string"},"___external_id":{"not":{"pattern":"^((CVE-\\d{4}-(0\\d{3}|[1-9]\\d{3,}))|(CAPEC-\\d+))$"},"description":"An identifier for the external reference content.","type":"string"}},"required":["source_name"]}],"$schema":"http:\/\/json-schema.org\/draft-07\/schema#","description":"External references are used to describe pointers to information represented outside of STIX.","title":"external-reference","type":"object","properties":{"___description":{"description":"A human readable description","type":"string"},"___hashes":{"$eref":{"patternProperties":{"___^SSDEEP$":{"pattern":"^[a-zA-Z0-9\/+:.]{1,128}$","description":"Specifies the ssdeep fuzzy hashing algorithm.","type":"string"},"___^SHA3-512$":{"pattern":"^[a-fA-F0-9]{128}$","description":"Specifies the SHA3-512 cryptographic hash function.","type":"string"},"___^SHA-512$":{"pattern":"^[a-fA-F0-9]{128}$","description":"Specifies the SHA-­512 cryptographic hash function (part of the SHA­2 family).","type":"string"},"___^SHA-1$":{"pattern":"^[a-fA-F0-9]{40}$","description":"Specifies the SHA­-1 (secure-­hash algorithm 1) cryptographic hash function.","type":"string"},"___^TLSH$":{"pattern":"^[a-zA-Z0-9]{70}$","description":"Specifies the TLSH locality-sensitive hashing algorithm.","type":"string"},"___^MD5$":{"pattern":"^[a-fA-F0-9]{32}$","description":"Specifies the MD5 message digest algorithm.","type":"string"},"___^SHA-256$":{"pattern":"^[a-fA-F0-9]{64}$","description":"Specifies the SHA-­256 cryptographic hash function (part of the SHA­2 family).","type":"string"},"___^SHA3-256$":{"pattern":"^[a-fA-F0-9]{64}$","description":"Specifies the SHA3-256 cryptographic hash function.","type":"string"},"___^[a-zA-Z0-9_-]{3,250}$":{"description":"Custom hash key","type":"string"}},"allOf":[{"$ref":"..\/common\/dictionary.json"}],"$schema":"http:\/\/json-schema.org\/draft-07\/schema#","description":"The Hashes type represents one or more cryptographic hashes, as a special set of key\/value pairs","additionalProperties":false,"title":"hashes","$id":"http:\/\/raw.githubusercontent.com\/oasis-open\/cti-stix2-json-schemas\/stix2.1\/schemas\/common\/hashes-type.json"},"description":"Specifies a dictionary of hashes for the file."},"___url":{"$eref":{"$schema":"http:\/\/json-schema.org\/draft-07\/schema#","pattern":"^([a-zA-Z][a-zA-Z0-9+.-]*):(?:\\\/\\\/((?:(?=((?:[a-zA-Z0-9-._~!$&'()*+,;=:]|%[0-9a-fA-F]{2})*))(\\3)@)?(?=((?:\\[?(?:::[a-fA-F0-9]+(?::[a-fA-F0-9]+)?|(?:[a-fA-F0-9]+:)+(?::[a-fA-F0-9]+)+|(?:[a-fA-F0-9]+:)+(?::|(?:[a-fA-F0-9]+:?)*))\\]?)|(?:[a-zA-Z0-9-._~!$&'()*+,;=]|%[0-9a-fA-F]{2})*))\\5(?::(?=(\\d*))\\6)?)(\\\/(?=((?:[a-zA-Z0-9-._~!$&'()*+,;=:@\\\/]|%[0-9a-fA-F]{2})*))\\8)?|(\\\/?(?!\\\/)(?=((?:[a-zA-Z0-9-._~!$&'()*+,;=:@\\\/]|%[0-9a-fA-F]{2})*))\\10)?)(?:\\?(?=((?:[a-zA-Z0-9-._~!$&'()*+,;=:@\\\/?]|%[0-9a-fA-F]{2})*))\\11)?(?:#(?=((?:[a-zA-Z0-9-._~!$&'()*+,;=:@\\\/?]|%[0-9a-fA-F]{2})*))\\12)?$","description":"Matches the elements of a URL using a regular expression.","title":"url-regex","type":"string","$id":"http:\/\/raw.githubusercontent.com\/oasis-open\/cti-stix2-json-schemas\/stix2.1\/schemas\/common\/url-regex.json"},"description":"A URL reference to an external resource."}},"$id":"http:\/\/raw.githubusercontent.com\/oasis-open\/cti-stix2-json-schemas\/stix2.1\/schemas\/common\/external-reference.json"}