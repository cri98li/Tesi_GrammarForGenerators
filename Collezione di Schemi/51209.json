{"oneOf":[{"properties":{"___source_name":{"pattern":"^cve$","description":"The source within which the external-reference is defined (system, registry, organization, etc.)","type":"string"},"___external_id":{"pattern":"^CVE-\\d{4}-(0\\d{3}|[1-9]\\d{3,})$","description":"An identifier for the external reference content.","type":"string"}},"required":["source_name","external_id"]},{"properties":{"___source_name":{"pattern":"^capec$","description":"The source within which the external-reference is defined (system, registry, organization, etc.)","type":"string"},"___external_id":{"pattern":"^CAPEC-\\d+$","description":"An identifier for the external reference content.","type":"string"}},"required":["source_name","external_id"]},{"anyOf":[{"required":["external_id"]},{"required":["description"]},{"required":["url"]}],"properties":{"___source_name":{"not":{"pattern":"^(cve)|(capec)$"},"description":"The source within which the external-reference is defined (system, registry, organization, etc.)","type":"string"},"___external_id":{"not":{"pattern":"^(CVE-\\d{4}-(0\\d{3}|[1-9]\\d{3,}))|(CAPEC-\\d+)$"},"description":"An identifier for the external reference content.","type":"string"}},"required":["source_name"]}],"$schema":"http:\/\/json-schema.org\/draft-04\/schema#","description":"External references are used to describe pointers to information represented outside of STIX.","title":"external-reference","type":"object","properties":{"___description":{"description":"A human readable description","type":"string"},"___url":{"$eref":{"$schema":"http:\/\/json-schema.org\/draft-04\/schema#","pattern":"^(?:(?:https?|ftp):\/\/)(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z¡-￿0-9]-*)*[a-z¡-￿0-9]+)(?:\\.(?:[a-z¡-￿0-9]-*)*[a-z¡-￿0-9]+)*(?:\\.(?:[a-z¡-￿]{2,}))\\.?)(?::\\d{2,5})?(?:[\/?#]\\S*)?$","description":"Matches the elements of a URL using a regular expression. Uses Diego Perini's regex from https:\/\/gist.github.com\/dperini\/729294.","title":"url","type":"string"},"description":"A URL reference to an external resource."}}}