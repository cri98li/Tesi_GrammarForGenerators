{"$schema":"http:\/\/json-schema.org\/draft-04\/schema#","description":"Build your program using the magic of magic!","additionalProperties":false,"title":"Program Template Builder","type":"object","definitions":{"_88Requirement":{"description":"A condition that should be satified to confirm this program is working","title":"Program Requirement","type":"object","properties":{"___name":{"description":"The human-friendly name of this requirement","type":"string","title":"Name"},"___query":{"description":"The results of this query will be used to validate this requirement has been satisfied","type":["string","null"],"title":"GraphQL Query"},"___description":{"description":"A description of how this requirement can be satisfied","type":"string","title":"Description"},"___key":{"description":"A unique identifier used to validate this requirement","type":"string","title":"Key"},"___queryVariables":{"description":"These are passed in as parameters to the query","type":["object","null"],"title":"GraphQL Query Variables"},"___longDescription":{"description":"Rich content regarding the implementation and other details relevant to this requirement","type":"string","title":"Long Description"}},"required":["key","name","description"]},"_88WidgetType":{"description":"A type of widget that is displayed by this program.","title":"Widget Type","type":"object","properties":{"___name":{"description":"A human-readable name for the widget type that gets displayed in the SaaSquatch portal during program setup. e.g. `Referrer Widget`","type":"string","title":"Name"},"___description":{"default":"We send this widget when a new reward is created by this program","description":"A human-readable description that explains this widget type. Displayed in the SaaSquatch portal during program setup. e.g. `This widget is sent when a new reward is created by this program`","type":"string","title":"Description"},"___key":{"pattern":"[a-zA-Z0-9]+","description":"A unique key to identify this widget type. Only numbers and latin characers are allowed. Widget types must be unique within the scope of a program. e.g. `ReferrerWidget`","type":"string","title":"Key"},"___defaults":{"$eref":{"$schema":"http:\/\/json-schema.org\/draft-04\/schema#","description":"Defines a web-component based widget template that uses vanilla HTML.","additionalProperties":false,"title":"HTML Widget Template Schema","type":"object","definitions":{"_88npmDependency":{"type":"object","properties":{"___version":{"default":"latest","description":"An NPM version string, such as Patch releases: 1.0 or 1.0.x or ~1.0.4 Minor releases: 1 or 1.x or ^1.0.4 Major releases: * or x","type":"string"},"___filePath":{"default":"","description":"The path to a resource in the specified package","type":"string"},"___package":{"description":"An NPM package name or scoped package","type":"string"}},"required":["version","package"]}},"properties":{"___htmlTemplate":{"description":"Raw HTML content that can use web components.","type":"string","title":"HTML Template"},"___meta":{"additionalProperties":false,"title":"Template Meta","type":"object","properties":{"___dependencies":{"description":"A list of NPM resources to load into the widget","type":"array","items":{"$ref":"#\/definitions\/npmDependency"}},"___plugins":{"description":"A list of component editors used in editing the widget","type":"array","items":{"$ref":"#\/definitions\/npmDependency"}}},"required":["dependencies","plugins"]}},"required":["meta","htmlTemplate"]}}}},"_88RewardType":{"description":"A type of reward that is given by this program.","title":"Reward Type","type":"object","properties":{"___name":{"default":"First Purchase Reward","description":"A human-readable name for the reward type that gets displayed in the SaaSquatch portal during program setup. e.g. `First Purchase Reward`","type":"string","title":"Name"},"___description":{"default":"This reward is given to people when they make their first purchase.","description":"A human-readable description that explains this reward type. Displayed in the SaaSquatch portal during program setup. e.g. `This reward is given to people when they make their first purchase.`","type":"string","title":"Description"},"___key":{"default":"firstPurchaseReward","pattern":"[a-zA-Z0-9]+","description":"A unique key to identify this reward type. Only numbers and latin characers are allowed. Reward types must be unique within the scope of a program. e.g. `FirstPurchaseReward`","title":"Key","type":"string"}}},"_88EmailType":{"description":"A type of email that is given by this program.","title":"Email Type","type":"object","properties":{"___name":{"default":"Reward Created Email","description":"A human-readable name for the email type that gets displayed in the SaaSquatch portal during program setup. e.g. `Reward Created Email`","type":"string","title":"Name"},"___description":{"default":"We send this email when a new reward is created by this program","description":"A human-readable description that explains this email type. Displayed in the SaaSquatch portal during program setup. e.g. `This email is sent when a new reward is created by this program`","type":"string","title":"Description"},"___key":{"default":"rewardCreatedEmail","pattern":"[a-zA-Z0-9]+","description":"A unique key to identify this email type. Only numbers and latin characers are allowed. Email types must be unique within the scope of a program. e.g. `RewardCreatedEmail`","title":"Key","type":"string"},"___defaults":{"oneOf":[{"type":"string","title":"Default Template Id"},{"$eref":{"$schema":"http:\/\/json-schema.org\/draft-04\/schema#","description":"Defines the customization points available in a Simple Email Template.","additionalProperties":false,"title":"Simple Email Template Schema","type":"object","properties":{"___content":{"additionalProperties":false,"title":"Content","type":"object","properties":{"___cta":{"type":"object","title":"Call to Action","properties":{"___link":{"title":"Link","type":"string"},"___text":{"title":"Text","type":"string"},"___enabled":{"default":false,"title":"Display CTA button?","type":"boolean"}}},"___footerContent":{"options":{"input_height":"50px","validate":["handlebars"]},"title":"Footer","type":"string"},"___headerContent":{"options":{"input_height":"50px","validate":["handlebars"]},"title":"Header","type":"string"},"___headerImage":{"title":"Header Image","type":"string"},"___bodyContent":{"options":{"validate":["handlebars"]},"description":"Supports markdown and handlebars expressions. e.g. *bold* _underline_ and [link](https:\/\/example.com)","title":"Body","type":"string"}},"required":["bodyContent"]},"___meta":{"additionalProperties":false,"title":"Email","type":"object","properties":{"___fromAddress":{"default":"company@example.com","propertyOrder":2,"minLength":5,"options":{"validate":["handlebars"]},"title":"From Address","type":"string"},"___fromName":{"default":"My Company","propertyOrder":1,"minLength":1,"options":{"validate":["handlebars"]},"title":"From Name","type":"string"},"___subject":{"propertyOrder":3,"minLength":1,"options":{"input_height":"50px","validate":["handlebars"]},"title":"Subject","type":"string"}},"required":["fromName","fromAddress","subject"]}},"required":["meta","content"]}},{"$eref":{"$schema":"http:\/\/json-schema.org\/draft-04\/schema#","description":"Defines the customization points available in an HTML body email template.","additionalProperties":false,"title":"HTML Email Template Schema","type":"object","properties":{"___htmlContent":{"description":"Raw HTML content that can use {{mergeTags}} from handlebars","type":"string","title":"HTML Content"},"___meta":{"additionalProperties":false,"title":"Email","type":"object","properties":{"___fromAddress":{"default":"company@example.com","propertyOrder":2,"minLength":5,"options":{"validate":["handlebars"]},"title":"From Address","type":"string"},"___fromName":{"default":"My Company","propertyOrder":1,"minLength":1,"options":{"validate":["handlebars"]},"title":"From Name","type":"string"},"___subject":{"propertyOrder":3,"minLength":1,"options":{"input_height":"50px","validate":["handlebars"]},"title":"Subject","type":"string"}},"required":["fromName","fromAddress","subject"]}},"required":["meta","htmlContent"]}}]}}}},"properties":{"___rules":{"options":{"hidden":true},"description":"The business rule variables define a JSON schema of the possible configuration points in the business logic.","title":"Business Rule Variables","type":"object"},"___requirements":{"description":"All of these conditions should be satisfied to confirm the program is working","type":["array","null"],"title":"Program Requirements","items":{"$eref":{"description":"A condition that should be satified to confirm this program is working","title":"Program Requirement","type":"object","properties":{"___name":{"description":"The human-friendly name of this requirement","type":"string","title":"Name"},"___query":{"description":"The results of this query will be used to validate this requirement has been satisfied","type":["string","null"],"title":"GraphQL Query"},"___description":{"description":"A description of how this requirement can be satisfied","type":"string","title":"Description"},"___key":{"description":"A unique identifier used to validate this requirement","type":"string","title":"Key"},"___queryVariables":{"description":"These are passed in as parameters to the query","type":["object","null"],"title":"GraphQL Query Variables"},"___longDescription":{"description":"Rich content regarding the implementation and other details relevant to this requirement","type":"string","title":"Long Description"}},"required":["key","name","description"]}}},"___rulesUISchema":{"description":"Defines how the rules will be shown via schema form","type":"object","title":"Rules UI Schema"},"___settings":{"type":"object","properties":{"___referrals":{"type":"object","properties":{"___enabled":{"description":"Whether this program supports referrals","type":"boolean"}}}}},"___installableByTenants":{"description":"The tenants that can install this program if it's not globally installable","type":["array","null"],"title":"Installable by Tenants","items":{"description":"The tenant alias for a tenant that can install this program","type":"string","title":"Tenant Alias"}},"___globallyInstallable":{"description":"Indicates whether this program can be installed by any tenant that support GA","type":"boolean","title":"Globally Installable"},"___widgets":{"description":"A list of all the possible types of widgets this program will send. Your business logic will trigger these based on key","type":"array","title":"Widgets","items":{"$eref":{"description":"A type of email that is given by this program.","title":"Email Type","type":"object","properties":{"___name":{"default":"Reward Created Email","description":"A human-readable name for the email type that gets displayed in the SaaSquatch portal during program setup. e.g. `Reward Created Email`","type":"string","title":"Name"},"___description":{"default":"We send this email when a new reward is created by this program","description":"A human-readable description that explains this email type. Displayed in the SaaSquatch portal during program setup. e.g. `This email is sent when a new reward is created by this program`","type":"string","title":"Description"},"___key":{"default":"rewardCreatedEmail","pattern":"[a-zA-Z0-9]+","description":"A unique key to identify this email type. Only numbers and latin characers are allowed. Email types must be unique within the scope of a program. e.g. `RewardCreatedEmail`","title":"Key","type":"string"},"___defaults":{"oneOf":[{"type":"string","title":"Default Template Id"},{"$ref":"SimpleEmail.schema.json#"},{"$ref":"HtmlEmail.schema.json#"}]}}}}},"___schedules":{"description":"The backend schedules that will run at a specified interval and trigger the program for specified users","type":["array","null"],"title":"Program Schedules","items":{"properties":{"___query":{"description":"The query used to create the program context when a user is evaluated by the schedule","type":"string","title":"Query"},"___key":{"description":"A unique identifier for this specific schedule","type":"string","title":"Schedule Key"},"___type":{"description":"The type of schedule to run","type":"string","title":"Schedule Type","enum":["USER","REWARD"]},"___filter":{"description":"The filter used to determine which users are evaluated when the schedule is run","type":"object","title":"Filter"},"___periodInHours":{"description":"The interval by which this schedule will run (e.g. every x hours)","type":"integer","title":"Period in Hours"}}}},"___userMetrics":{"description":"Custom metrics defined by this program that will only be activated when the program is live","type":"array","title":"Program User Metrics","items":{"$eref":{"$schema":"http:\/\/json-schema.org\/draft-06\/schema#","description":"User metrics establish how aggregate functions can be used to update a custom user field with respect to an event.","title":"Metric","type":"object","definitions":{"_88singleFieldAggregate":{"additionalProperties":false,"type":"object","properties":{"___fieldName":{"$ref":"#\/definitions\/fieldName"}},"required":["fieldName"]},"_88filter":{"description":"Aggregate operator filter","title":"Filter","type":"object","properties":{"___operator":{"description":"The operator that will be used in applying the filter","type":"string","title":"Operator","enum":["eq","gt","gte","lt","lte","exists","or"]}},"required":["operator"],"dependencies":{"operator":{"oneOf":[{"additionalProperties":false,"properties":{"___value":{"description":"Filters provided will be evaluated using the OR conditional.","type":"array","title":"OR Filters","items":{"$ref":"#\/definitions\/filter"}},"___operator":{"enum":["or"]}},"required":["value"]},{"additionalProperties":false,"properties":{"___field":{"description":"The filter operator will be applied to this event field","type":"string","title":"Field Name"},"___value":{"description":"The value the filter operator will match on","type":["string","integer","boolean"],"title":"Field Value"},"___operator":{"enum":["eq","gt","gte","lt","lte","exists"]}},"required":["operator","value"]}]}}},"_88fieldName":{"description":"The field on which this aggregate will be performed.","type":"string","title":"Field Name"}},"properties":{"___eventKey":{"description":"The event that will be aggregated by this metric.","type":"string","title":"Event Key"},"___customFieldKey":{"description":"The name of the custom field associated with this metric. ","type":"string","title":"Custom Field"},"___dateTriggeredWindow":{"description":"An ISO 8601 interval. The aggregate operation will only be performed between this window.","type":"string","title":"Date Triggered Window"},"___aggregateId":{"description":"An unique identifier for the aggregate operation to perform.","type":"string","title":"Aggregate Identifier","enum":["SUM","COUNT","FIRST_SEEN","FIRST_VALUE","LAST_VALUE","THROTTLED_LAST_NUMERIC_VALUE"]},"___fieldsFilters":{"description":"The aggregate operation will only be performed for events matching these filters","type":"array","title":"Metric Fields Filters","items":{"$ref":"#\/definitions\/filter"}},"___id":{"description":"A unique identifier for this metric. This should be an ObjectId.","type":"string","title":"Identifier"}},"required":["id","customFieldKey","aggregateId","eventKey"],"dependencies":{"aggregateId":{"oneOf":[{"properties":{"___aggregateRules":{"$ref":"#\/definitions\/singleFieldAggregate"},"___aggregateId":{"enum":["SUM"]}}},{"properties":{"___aggregateId":{"enum":["COUNT"]}}},{"properties":{"___aggregateId":{"enum":["FIRST_SEEN"]}}},{"properties":{"___aggregateRules":{"$ref":"#\/definitions\/singleFieldAggregate"},"___aggregateId":{"enum":["FIRST_VALUE"]}}},{"properties":{"___aggregateRules":{"$ref":"#\/definitions\/singleFieldAggregate"},"___aggregateId":{"enum":["LAST_VALUE"]}}},{"properties":{"___aggregateRules":{"additionalProperties":false,"type":"object","properties":{"___diff":{"description":"The minimum interval time that can elapse between recording the value of field name. Default is milliseconds per hour.","type":"string","title":"Throttle Interval"},"___fieldName":{"$ref":"#\/definitions\/fieldName"}},"required":["fieldName"]},"___aggregateId":{"enum":["THROTTLED_LAST_NUMERIC_VALUE"]}}}]}}}}},"___longDescription":{"options":{"expand_height":true},"description":"A long-form article that sells the benefits of this program. Dispayed in the SaaSquatch Portal during Program setup.","type":"string","title":"Program Long Description"},"___name":{"description":"A human-readable name for the program. Dispayed in the SaaSquatch Portal during Program setup.","type":"string","title":"Program Name"},"___trigger":{"description":"Defines specific triggers for this program","type":"object","title":"Program Triggers","properties":{"___eventKeys":{"description":"A list of events that can trigger this program","type":"array","title":"Event Keys","items":{"description":"When an event with this key is received this program will be triggered","type":"string","title":"Event Key"}}}},"___logo":{"description":"The URL for the logo associated with this program","type":"string","title":"Logo URL"},"___url":{"description":"The URL that will be requested for this program when triggered","type":"string","title":"Webtask URL"},"___rewards":{"description":"A list of all the possible types of rewards this program will give. Your business logic will trigger these based on key","type":"array","title":"Rewards","items":{"$eref":{"description":"A type of reward that is given by this program.","title":"Reward Type","type":"object","properties":{"___name":{"default":"First Purchase Reward","description":"A human-readable name for the reward type that gets displayed in the SaaSquatch portal during program setup. e.g. `First Purchase Reward`","type":"string","title":"Name"},"___description":{"default":"This reward is given to people when they make their first purchase.","description":"A human-readable description that explains this reward type. Displayed in the SaaSquatch portal during program setup. e.g. `This reward is given to people when they make their first purchase.`","type":"string","title":"Description"},"___key":{"default":"firstPurchaseReward","pattern":"[a-zA-Z0-9]+","description":"A unique key to identify this reward type. Only numbers and latin characers are allowed. Reward types must be unique within the scope of a program. e.g. `FirstPurchaseReward`","title":"Key","type":"string"}}},"headerTemplate":"{{ self.name }}"}},"___rulesMigrationScript":{"description":"A JSONata script that transforms program rules JSON to be compatible with the most recently published schema version","type":"string","title":"Rules Migration Script"},"___installGuide":{"description":"This describes how to setup the current program and may update depending on how you've configured your program rules","type":"string","title":"Program Install Guide"},"___sharing":{"type":["object","null"],"title":"Sharing","properties":{"___linksConfig":{"description":"Message links configuration (default share text\/content for Open Graph\/Twitter\/etc)","type":"object","title":"Links Configuration","properties":{"___defaults":{"$eref":{"$schema":"http:\/\/json-schema.org\/draft-04\/schema#","description":"Defines the configurable share messages provided by this program.","additionalProperties":false,"title":"Program Messaging","type":"object","definitions":{"_88linkedin":{"additionalProperties":false,"type":"object","properties":{"___config":{"additionalProperties":false,"title":"LinkedIn","type":"object","properties":{"___linkedinShareBody":{"minLength":4,"type":"string","title":"LinkedIn Share Body"},"___linkedinShareImageURL":{"type":"string","title":"LinkedIn URL Image"},"___linkedinShareSubject":{"minLength":4,"type":"string","title":"LinkedIn Share Subject"}},"required":["linkedinShareSubject","linkedinShareBody","linkedinShareImageURL"]},"___shareMedium":{"default":"LINKEDIN","type":"string","enum":["LINKEDIN"]}}},"_88email":{"additionalProperties":false,"type":"object","properties":{"___config":{"additionalProperties":false,"title":"Email","type":"object","properties":{"___emailShareBody":{"minLength":4,"type":"string","title":"Email Share Body"},"___emailShareSubject":{"minLength":4,"type":"string","title":"Email Share Subject"}},"required":["emailShareSubject","emailShareBody"]},"___shareMedium":{"default":"EMAIL","type":"string","enum":["EMAIL"]}}},"_88sms":{"additionalProperties":false,"type":"object","properties":{"___config":{"additionalProperties":false,"title":"SMS","type":"object","properties":{"___smsShareBody":{"minLength":4,"type":"string","title":"SMS Share Body"}},"required":["smsShareBody"]},"___shareMedium":{"default":"SMS","type":"string","enum":["SMS"]}}},"_88whatsapp":{"additionalProperties":false,"type":"object","properties":{"___config":{"additionalProperties":false,"title":"WhatsApp","type":"object","properties":{"___whatsAppShareBody":{"minLength":4,"type":"string","title":"WhatsApp Share Body"}},"required":["whatsAppShareBody"]},"___shareMedium":{"default":"WHATSAPP","type":"string","enum":["WHATSAPP"]}}},"_88twitter":{"additionalProperties":false,"type":"object","properties":{"___config":{"additionalProperties":false,"title":"Twitter","type":"object","properties":{"___twitterShareBody":{"minLength":4,"type":"string","title":"Twitter Share Body"}},"required":["twitterShareBody"]},"___shareMedium":{"default":"TWITTER","type":"string","enum":["TWITTER"]}}},"_88openGraph":{"type":"object","title":"Share Link Open Graph","properties":{"___source":{"default":"LANDING_PAGE","enumNames":["Hosted","Landing Page"],"type":"string","enum":["HOSTED","LANDING_PAGE"]}},"dependencies":{"source":{"oneOf":[{"additionalProperties":false,"properties":{"___description":{"minLength":4,"type":"string","title":"Description"},"___title":{"minLength":4,"type":"string","title":"Title"},"___image":{"type":"string","title":"Image"},"___source":{"enum":["HOSTED"]}},"required":["source","title","description","image"]},{"additionalProperties":false,"properties":{"___source":{"enum":["LANDING_PAGE"]}},"required":["source"]}]}}},"_88linemessenger":{"additionalProperties":false,"type":"object","properties":{"___config":{"additionalProperties":false,"title":"Line Messenger","type":"object","properties":{"___lineMessengerShareBody":{"minLength":4,"type":"string","title":"Line Messenger Share Body"}},"required":["lineMessengerShareBody"]},"___shareMedium":{"default":"LINEMESSENGER","type":"string","enum":["LINEMESSENGER"]}}},"_88pinterest":{"additionalProperties":false,"type":"object","properties":{"___config":{"additionalProperties":false,"title":"Pinterest","type":"object","properties":{"___pinterestImageURL":{"type":"string","title":"Pinterest Image URL"},"___pinterestShareBody":{"minLength":4,"type":"string","title":"Pinterest Share Body"}},"required":["pinterestShareBody","pinterestImageURL"]},"___shareMedium":{"default":"PINTEREST","type":"string","enum":["PINTEREST"]}}}},"properties":{"___messages":{"additionalItems":false,"type":"array","title":"Share Messages","items":[{"$ref":"#\/definitions\/twitter"},{"$ref":"#\/definitions\/email"},{"$ref":"#\/definitions\/linkedin"},{"$ref":"#\/definitions\/sms"},{"$ref":"#\/definitions\/whatsapp"},{"$ref":"#\/definitions\/linemessenger"},{"$ref":"#\/definitions\/pinterest"}]},"___messageLinkOpenGraph":{"$ref":"#\/definitions\/openGraph"},"___shareLinkOpenGraph":{"$ref":"#\/definitions\/openGraph"}},"required":["shareLinkOpenGraph","messageLinkOpenGraph","messages"]}}}},"___enabled":{"description":"When sharing is enabled the program will create\/support referral share links","type":"boolean","title":"Sharing Enabled"}}},"___summary":{"description":"A human-readable summary of the program. Dispayed in the SaaSquatch Portal during Program setup.","type":"string","title":"Program Summary"},"___emails":{"description":"A list of all the possible types of emails this program will send. Your business logic will trigger these based on key","type":"array","title":"Emails","items":{"$eref":{"description":"A type of email that is given by this program.","title":"Email Type","type":"object","properties":{"___name":{"default":"Reward Created Email","description":"A human-readable name for the email type that gets displayed in the SaaSquatch portal during program setup. e.g. `Reward Created Email`","type":"string","title":"Name"},"___description":{"default":"We send this email when a new reward is created by this program","description":"A human-readable description that explains this email type. Displayed in the SaaSquatch portal during program setup. e.g. `This email is sent when a new reward is created by this program`","type":"string","title":"Description"},"___key":{"default":"rewardCreatedEmail","pattern":"[a-zA-Z0-9]+","description":"A unique key to identify this email type. Only numbers and latin characers are allowed. Email types must be unique within the scope of a program. e.g. `RewardCreatedEmail`","title":"Key","type":"string"},"___defaults":{"oneOf":[{"type":"string","title":"Default Template Id"},{"$ref":"SimpleEmail.schema.json#"},{"$ref":"HtmlEmail.schema.json#"}]}}},"headerTemplate":"{{ self.name }}"}},"___schedule":{"title":"Recurring schedule","type":["object","null"],"properties":{"___userFilter":{"description":"This should be a GraphQL-compatible query json object","type":"object","title":"User Filter"},"___periodInHours":{"description":"Your program logic will be run on this schedule.","type":"number"}}},"___id":{"description":"The unique contentful ID associated with this program template","type":"string","title":"ID"}}}