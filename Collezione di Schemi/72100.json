{"$schema":"http:\/\/json-schema.org\/draft-06\/schema#","description":"User metrics establish how aggregate functions can be used to update a custom user field with respect to an event.","title":"Metric","type":"object","definitions":{"_88singleFieldAggregate":{"additionalProperties":false,"type":"object","properties":{"___fieldName":{"$eref":{"description":"The field on which this aggregate will be performed.","type":"string","title":"Field Name"}}},"required":["fieldName"]},"_88filter":{"description":"Aggregate operator filter","title":"Filter","type":"object","properties":{"___operator":{"description":"The operator that will be used in applying the filter","type":"string","title":"Operator","enum":["eq","gt","gte","lt","lte","exists","or"]}},"required":["operator"],"dependencies":{"operator":{"oneOf":[{"additionalProperties":false,"properties":{"___value":{"description":"Filters provided will be evaluated using the OR conditional.","type":"array","title":"OR Filters","items":{"$eref":{"description":"Aggregate operator filter","title":"Filter","type":"object","properties":{"___operator":{"description":"The operator that will be used in applying the filter","type":"string","title":"Operator","enum":["eq","gt","gte","lt","lte","exists","or"]}},"required":["operator"],"dependencies":{"operator":{"oneOf":[{"additionalProperties":false,"properties":{"___value":{"description":"Filters provided will be evaluated using the OR conditional.","type":"array","title":"OR Filters","items":{"$ref":"#\/definitions\/filter"}},"___operator":{"enum":["or"]}},"required":["value"]},{"additionalProperties":false,"properties":{"___field":{"description":"The filter operator will be applied to this event field","type":"string","title":"Field Name"},"___value":{"description":"The value the filter operator will match on","type":["string","integer","boolean"],"title":"Field Value"},"___operator":{"enum":["eq","gt","gte","lt","lte","exists"]}},"required":["operator","value"]}]}}}}},"___operator":{"enum":["or"]}},"required":["value"]},{"additionalProperties":false,"properties":{"___field":{"description":"The filter operator will be applied to this event field","type":"string","title":"Field Name"},"___value":{"description":"The value the filter operator will match on","type":["string","integer","boolean"],"title":"Field Value"},"___operator":{"enum":["eq","gt","gte","lt","lte","exists"]}},"required":["operator","value"]}]}}},"_88fieldName":{"description":"The field on which this aggregate will be performed.","type":"string","title":"Field Name"}},"properties":{"___eventKey":{"description":"The event that will be aggregated by this metric.","type":"string","title":"Event Key"},"___customFieldKey":{"description":"The name of the custom field associated with this metric. ","type":"string","title":"Custom Field"},"___dateTriggeredWindow":{"description":"An ISO 8601 interval. The aggregate operation will only be performed between this window.","type":"string","title":"Date Triggered Window"},"___aggregateId":{"description":"An unique identifier for the aggregate operation to perform.","type":"string","title":"Aggregate Identifier","enum":["SUM","COUNT","FIRST_SEEN","FIRST_VALUE","LAST_VALUE","THROTTLED_LAST_NUMERIC_VALUE"]},"___fieldsFilters":{"description":"The aggregate operation will only be performed for events matching these filters","type":"array","title":"Metric Fields Filters","items":{"$eref":{"description":"Aggregate operator filter","title":"Filter","type":"object","properties":{"___operator":{"description":"The operator that will be used in applying the filter","type":"string","title":"Operator","enum":["eq","gt","gte","lt","lte","exists","or"]}},"required":["operator"],"dependencies":{"operator":{"oneOf":[{"additionalProperties":false,"properties":{"___value":{"description":"Filters provided will be evaluated using the OR conditional.","type":"array","title":"OR Filters","items":{"$ref":"#\/definitions\/filter"}},"___operator":{"enum":["or"]}},"required":["value"]},{"additionalProperties":false,"properties":{"___field":{"description":"The filter operator will be applied to this event field","type":"string","title":"Field Name"},"___value":{"description":"The value the filter operator will match on","type":["string","integer","boolean"],"title":"Field Value"},"___operator":{"enum":["eq","gt","gte","lt","lte","exists"]}},"required":["operator","value"]}]}}}}},"___id":{"description":"A unique identifier for this metric. This should be an ObjectId.","type":"string","title":"Identifier"}},"required":["id","customFieldKey","aggregateId","eventKey"],"dependencies":{"aggregateId":{"oneOf":[{"properties":{"___aggregateRules":{"$eref":{"additionalProperties":false,"type":"object","properties":{"___fieldName":{"$ref":"#\/definitions\/fieldName"}},"required":["fieldName"]}},"___aggregateId":{"enum":["SUM"]}}},{"properties":{"___aggregateId":{"enum":["COUNT"]}}},{"properties":{"___aggregateId":{"enum":["FIRST_SEEN"]}}},{"properties":{"___aggregateRules":{"$eref":{"additionalProperties":false,"type":"object","properties":{"___fieldName":{"$ref":"#\/definitions\/fieldName"}},"required":["fieldName"]}},"___aggregateId":{"enum":["FIRST_VALUE"]}}},{"properties":{"___aggregateRules":{"$eref":{"additionalProperties":false,"type":"object","properties":{"___fieldName":{"$ref":"#\/definitions\/fieldName"}},"required":["fieldName"]}},"___aggregateId":{"enum":["LAST_VALUE"]}}},{"properties":{"___aggregateRules":{"additionalProperties":false,"type":"object","properties":{"___diff":{"description":"The minimum interval time that can elapse between recording the value of field name. Default is milliseconds per hour.","type":"string","title":"Throttle Interval"},"___fieldName":{"$eref":{"description":"The field on which this aggregate will be performed.","type":"string","title":"Field Name"}}},"required":["fieldName"]},"___aggregateId":{"enum":["THROTTLED_LAST_NUMERIC_VALUE"]}}}]}}}