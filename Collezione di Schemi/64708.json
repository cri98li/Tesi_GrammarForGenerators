{"allOf":[{"$eref":{"patternProperties":{"___^[a-z0-9_]{3,250}$":{"anyOf":[{"minItems":1,"type":"array"},{"type":"string"},{"type":"integer"},{"type":"boolean"},{"type":"number"},{"type":"object"}]}},"not":{"anyOf":[{"required":["severity"]},{"required":["action"]},{"required":["usernames"]},{"required":["phone_numbers"]}]},"$schema":"http:\/\/json-schema.org\/draft-07\/schema#","description":"Common properties and behavior across all STIX Domain Objects and STIX Relationship Objects.","additionalProperties":false,"title":"core","type":"object","properties":{"___type":{"not":{"enum":["incident","action"]},"minLength":3,"pattern":"^\\-?[a-zA-Z0-9]+(-[a-zA-Z0-9]+)*\\-?$","description":"The type property identifies the type of STIX Object (SDO, Relationship Object, etc). The value of the type field MUST be one of the types defined by a STIX Object (e.g., indicator).","title":"type","type":"string","maxLength":250},"___granular_markings":{"minItems":1,"description":"The set of granular markings that apply to this object.","type":"array","items":{"$ref":"..\/common\/granular-marking.json"}},"___external_references":{"minItems":1,"description":"A list of external references which refers to non-STIX information.","type":"array","items":{"$ref":"..\/common\/external-reference.json"}},"___labels":{"minItems":1,"description":"The labels property specifies a set of terms used to describe this object.","type":"array","items":{"type":"string"}},"___created":{"allOf":[{"$ref":"..\/common\/timestamp.json"},{"pattern":"T\\d{2}:\\d{2}:\\d{2}\\.\\d{3}Z$","title":"timestamp_millis"}],"description":"The created property represents the time at which the first version of this object was created. The timstamp value MUST be precise to the nearest millisecond."},"___created_by_ref":{"description":"The ID of the Source object that describes who created this object.","$ref":"..\/common\/identifier.json"},"___lang":{"description":"Identifies the language of the text content in this object.","type":"string"},"___object_marking_refs":{"minItems":1,"description":"The list of marking-definition objects to be applied to this object.","type":"array","items":{"$ref":"..\/common\/identifier.json"}},"___revoked":{"description":"The revoked property indicates whether the object has been revoked.","type":"boolean"},"___spec_version":{"description":"The version of the STIX specification used to represent this object.","type":"string","enum":["2.0","2.1"]},"___modified":{"allOf":[{"$ref":"..\/common\/timestamp.json"},{"pattern":"T\\d{2}:\\d{2}:\\d{2}\\.\\d{3}Z$","title":"timestamp_millis"}],"description":"The modified property represents the time that this particular version of the object was modified. The timstamp value MUST be precise to the nearest millisecond."},"___id":{"description":"The id property universally and uniquely identifies this object.","$ref":"..\/common\/identifier.json"},"___confidence":{"maximum":100,"description":"Identifies the confidence that the creator has in the correctness of their data.","type":"integer","minimum":0}},"required":["type","spec_version","id","created","modified"],"$id":"http:\/\/raw.githubusercontent.com\/oasis-open\/cti-stix2-json-schemas\/stix2.1\/schemas\/common\/core.json"}},{"properties":{"___kill_chain_phases":{"minItems":1,"description":"The list of kill chain phases for which this Malware instance can be used.","type":"array","items":{"$eref":{"$schema":"http:\/\/json-schema.org\/draft-07\/schema#","description":"The kill-chain-phase represents a phase in a kill chain.","title":"kill-chain-phase","type":"object","properties":{"___phase_name":{"description":"The name of the phase in the kill chain.","type":"string"},"___kill_chain_name":{"description":"The name of the kill chain.","type":"string"}},"required":["kill_chain_name","phase_name"],"$id":"http:\/\/raw.githubusercontent.com\/oasis-open\/cti-stix2-json-schemas\/stix2.1\/schemas\/common\/kill-chain-phase.json"}}},"___type":{"description":"The type of this object, which MUST be the literal `malware`.","type":"string","enum":["malware"]},"___malware_types":{"minItems":1,"description":"The type of malware being described. Open Vocab - malware-type-ov","type":"array","items":{"type":"string"}},"___implementation_languages":{"minItems":1,"description":"The programming language(s) used to implement the malware instance or family. Open Vocab - implementation-language-ov.","type":"array","items":{"type":"string"}},"___aliases":{"minItems":1,"description":"Alternative names used to identify this Malware or Malware family.","type":"array","items":{"type":"string"}},"___sample_refs":{"minItems":1,"description":"The sample_refs property specifies a list of identifiers of the SCO file or artifact objects associated with this malware instance(s) or family.","type":"array","items":{"type":"string"}},"___last_seen":{"$eref":{"$schema":"http:\/\/json-schema.org\/draft-07\/schema#","pattern":"^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?Z$","description":"Represents timestamps across the CTI specifications. The format is an RFC3339 timestamp, with a required timezone specification of 'Z'.","title":"timestamp","type":"string","$id":"http:\/\/raw.githubusercontent.com\/oasis-open\/cti-stix2-json-schemas\/stix2.1\/schemas\/common\/timestamp.json"},"description":"The time that the malware family or malware instance was last seen."},"___name":{"description":"The name used to identify the Malware.","type":"string"},"___architecture_execution_envs":{"minItems":1,"description":"The processor architectures (e.g., x86, ARM, etc.) that the malware instance or family is executable on. Open Vocab - processor-architecture-os.","type":"array","items":{"type":"string"}},"___description":{"description":"Provides more context and details about the Malware object.","type":"string"},"___os_execution_envs":{"minItems":1,"description":"The operating systems that the malware family or malware instance is executable on.","type":"array","items":{"type":"string"}},"___capabilities":{"minItems":1,"description":"Specifies any capabilities identified for the malware instance or family. Open Vocab - malware-capabilities-ov.","type":"array","items":{"type":"string"}},"___id":{"pattern":"^malware--","title":"id"},"___first_seen":{"$eref":{"$schema":"http:\/\/json-schema.org\/draft-07\/schema#","pattern":"^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?Z$","description":"Represents timestamps across the CTI specifications. The format is an RFC3339 timestamp, with a required timezone specification of 'Z'.","title":"timestamp","type":"string","$id":"http:\/\/raw.githubusercontent.com\/oasis-open\/cti-stix2-json-schemas\/stix2.1\/schemas\/common\/timestamp.json"},"description":"The time that the malware instance or family was first seen."}}}],"oneOf":[{"properties":{"___is_family":{"description":"Whether the object represents a malware family (if true) or a malware instance (if false).","type":"boolean","enum":[false]}}},{"properties":{"___is_family":{"description":"Whether the object represents a malware family (if true) or a malware instance (if false).","type":"boolean","enum":[true]}},"required":["name"]}],"$schema":"http:\/\/json-schema.org\/draft-07\/schema#","description":"Malware is a type of TTP that is also known as malicious code and malicious software, refers to a program that is inserted into a system, usually covertly, with the intent of compromising the confidentiality, integrity, or availability of the victim's data, applications, or operating system (OS) or of otherwise annoying or disrupting the victim.","title":"malware","type":"object","definitions":{"_88implementation-language-ov":{"type":"string","enum":["applescript","bash","c","c++","c#","go","java","javascript","lua","objective-c","perl","php","powershell","python","ruby","scala","swift","typescript","visual-basic","x86-32","x86-64"]},"_88malware-type-ov":{"type":"string","enum":["adware","backdoor","bot","bootkit","ddos","downloader","dropper","exploit-kit","keylogger","ransomware","remote-access-trojan","resource-exploitation","rogue-security-software","rootkit","screen-capture","spyware","trojan","unknown","virus","webshell","wiper","worm"]},"_88malware-capabilities-ov":{"type":"string","enum":["accesses-remote-machines","anti-debugging","anti-disassembly","anti-emulation","anti-memory-forensics","anti-sandbox","anti-vm","captures-input-peripherals","captures-output-peripherals","captures-system-state-data","cleans-traces-of-infection","commits-fraud","communicates-with-c2","compromises-data-availability","compromises-data-integrity","compromises-system-availability","controls-local-machine","degrades-security-software","degrades-system-updates","determines-c2-server","emails-spam","escalates-privileges","evades-av","exfiltrates-data","fingerprints-host","hides-artifacts","hides-executing-code","infects-files","infects-remote-machines","installs-other-components","persists-after-system-reboot","prevents-artifact-access","prevents-artifact-deletion","probes-network-environment","self-modifies","steals-authentication-credentials","violates-system-operational-integrity"]},"_88processor-architecture-ov":{"type":"string","enum":["alpha","arm","ia-64","mips","powerpc","sparc","x86","x86-64"]}},"required":["malware_types","is_family"],"$id":"http:\/\/raw.githubusercontent.com\/oasis-open\/cti-stix2-json-schemas\/stix2.1\/schemas\/sdos\/malware.json"}