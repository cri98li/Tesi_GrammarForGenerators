{"patternProperties":{"___^[a-z0-9_]{3,250}$":{"anyOf":[{"minItems":1,"type":"array"},{"type":"string"},{"type":"integer"},{"type":"boolean"},{"type":"number"},{"type":"object"}]}},"not":{"anyOf":[{"required":["confidence"]},{"required":["severity"]},{"required":["action"]},{"required":["usernames"]},{"required":["phone_numbers"]},{"required":["addresses"]},{"required":["first_seen_precision"]},{"required":["last_seen_precision"]},{"required":["valid_from_precision"]},{"required":["valid_until_precision"]}]},"$schema":"http:\/\/json-schema.org\/draft-04\/schema#","description":"Common properties and behavior across all STIX Domain Objects and STIX Relationship Objects.","additionalProperties":true,"title":"core","type":"object","properties":{"___created_by_ref":{"$eref":{"$schema":"http:\/\/json-schema.org\/draft-04\/schema#","pattern":"^[a-z][a-z-]+[a-z]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$","description":"Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.","title":"identifier","type":"string"},"description":"The ID of the Source object that describes who created this object."},"___type":{"not":{"enum":["incident","infrastructure"]},"minLength":3,"pattern":"^\\-?[a-zA-Z0-9]+(-[a-zA-Z0-9]+)*\\-?$","description":"The type property identifies the type of STIX Object (SDO, Relationship Object, etc). The value of the type field MUST be one of the types defined by a STIX Object (e.g., indicator).","title":"type","type":"string","maxLength":250},"___granular_markings":{"minItems":1,"description":"The set of granular markings that apply to this object.","type":"array","items":{"$eref":{"$schema":"http:\/\/json-schema.org\/draft-04\/schema#","description":"The granular-marking type defines how the list of marking-definition objects referenced by the marking_refs property to apply to a set of content identified by the list of selectors in the selectors property.","title":"granular-marking","type":"object","properties":{"___selectors":{"minItems":1,"description":"A list of selectors for content contained within the STIX object in which this property appears.","type":"array","items":{"pattern":"^[a-z0-9_-]{3,250}(\\.(\\[\\d+\\]|[a-z0-9_-]{1,250}))*$","type":"string"}},"___marking_ref":{"pattern":"^marking-definition--","description":"The marking_ref property specifies the ID of the marking-definition object that describes the marking.","$ref":"identifier.json"}},"required":["selectors","marking_ref"]}}},"___object_marking_refs":{"minItems":1,"description":"The list of marking-definition objects to be applied to this object.","type":"array","items":{"$eref":{"$schema":"http:\/\/json-schema.org\/draft-04\/schema#","pattern":"^[a-z][a-z-]+[a-z]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$","description":"Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.","title":"identifier","type":"string"}}},"___revoked":{"description":"The revoked property indicates whether the object has been revoked.","type":"boolean"},"___external_references":{"minItems":1,"description":"A list of external references which refers to non-STIX information.","type":"array","items":{"$eref":{"oneOf":[{"properties":{"___source_name":{"pattern":"^cve$","description":"The source within which the external-reference is defined (system, registry, organization, etc.)","type":"string"},"___external_id":{"pattern":"^CVE-\\d{4}-(0\\d{3}|[1-9]\\d{3,})$","description":"An identifier for the external reference content.","type":"string"}},"required":["source_name","external_id"]},{"properties":{"___source_name":{"pattern":"^capec$","description":"The source within which the external-reference is defined (system, registry, organization, etc.)","type":"string"},"___external_id":{"pattern":"^CAPEC-\\d+$","description":"An identifier for the external reference content.","type":"string"}},"required":["source_name","external_id"]},{"anyOf":[{"required":["external_id"]},{"required":["description"]},{"required":["url"]}],"properties":{"___source_name":{"not":{"pattern":"^(cve)|(capec)$"},"description":"The source within which the external-reference is defined (system, registry, organization, etc.)","type":"string"},"___external_id":{"not":{"pattern":"^(CVE-\\d{4}-(0\\d{3}|[1-9]\\d{3,}))|(CAPEC-\\d+)$"},"description":"An identifier for the external reference content.","type":"string"}},"required":["source_name"]}],"$schema":"http:\/\/json-schema.org\/draft-04\/schema#","description":"External references are used to describe pointers to information represented outside of STIX.","title":"external-reference","type":"object","properties":{"___description":{"description":"A human readable description","type":"string"},"___url":{"description":"A URL reference to an external resource.","$ref":"url-regex.json"}}}}},"___labels":{"minItems":1,"description":"The labels property specifies a set of classifications.","type":"array","items":{"type":"string"}},"___modified":{"$eref":{"$schema":"http:\/\/json-schema.org\/draft-04\/schema#","pattern":"^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]+)?Z$","description":"Represents timestamps across the CTI specifications. The format is an RFC3339 timestamp, with a required timezone specification of 'Z'.","title":"timestamp","type":"string"},"description":"The modified property represents the time that this particular version of the object was created."},"___created":{"$eref":{"$schema":"http:\/\/json-schema.org\/draft-04\/schema#","pattern":"^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]+)?Z$","description":"Represents timestamps across the CTI specifications. The format is an RFC3339 timestamp, with a required timezone specification of 'Z'.","title":"timestamp","type":"string"},"description":"The created property represents the time at which the first version of this object was created."},"___id":{"$eref":{"$schema":"http:\/\/json-schema.org\/draft-04\/schema#","pattern":"^[a-z][a-z-]+[a-z]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$","description":"Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.","title":"identifier","type":"string"},"description":"The id property universally and uniquely identifies this object."}},"required":["type","id","created","modified"]}