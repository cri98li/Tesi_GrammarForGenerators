{"endpoint":{"additionalProperties":false,"type":"object","properties":{"___name":{"$fref":"common.json#\/endpoint"},"___proto":{"pattern":"^tcp$|^udp$","type":"string"},"___type":{"pattern":"^infra$","type":"string"},"___port":{"maximum":65535,"type":"integer","minimum":0}},"required":["name","port"]},"$schema":"http:\/\/json-schema.org\/draft-04\/schema#","resource":{"additionalProperties":false,"type":"object","properties":{"___services":{"type":"array","items":{"$eref":{"additionalProperties":false,"type":"object","properties":{"___name":{"pattern":"^[\\w\\-\\.]+$","type":"string","maxLength":60},"___restart":{"additionalProperties":false,"type":"object","properties":{"___interval":{"maximum":600,"type":"integer","minimum":30},"___limit":{"maximum":10,"type":"integer","minimum":0}},"required":["limit"]},"___command":{"type":"string"},"___root":{"type":"boolean"}},"required":["name","command"]}}},"___shared_ip":{"type":"boolean"},"___environ":{"type":"array","items":{"$eref":{"additionalProperties":false,"type":"object","properties":{"___name":{"type":"string"},"___value":{"type":"string"}},"required":["name","value"]}}},"___memory":{"$fref":"common.json#\/memory"},"___args":{"type":"array","items":{"type":"string"}},"___ephemeral_ports":{"$eref":{"additionalProperties":false,"type":"object","properties":{"___tcp":{"maximum":255,"type":"integer","minimum":0},"___udp":{"maximum":255,"type":"integer","minimum":0}}}},"___image":{"pattern":"^native:|docker:\/\/.+|http:\/\/.+|file:\/\/.+$","type":"string"},"___cpu":{"$fref":"common.json#\/cpu"},"___disk":{"$fref":"common.json#\/disk"},"___features":{"type":"array","items":{"pattern":"^[\\w\\-]+$","type":"string"}},"___schedule_once":{"type":"boolean"},"___tickets":{"type":"array","items":{"$fref":"common.json#\/ticket"}},"___shared_network":{"type":"boolean"},"___passthrough":{"type":"array","items":{"anyOf":[{"format":"hostname","type":"string"},{"format":"ipv4","type":"string"}]}},"___identity_group":{"$fref":"common.json#\/identity_group_id"},"___endpoints":{"type":"array","items":{"$eref":{"additionalProperties":false,"type":"object","properties":{"___name":{"$ref":"common.json#\/endpoint"},"___proto":{"pattern":"^tcp$|^udp$","type":"string"},"___type":{"pattern":"^infra$","type":"string"},"___port":{"maximum":65535,"type":"integer","minimum":0}},"required":["name","port"]}}},"___vring":{"type":"object","properties":{"___rules":{"minItems":1,"type":"array","items":{"$eref":{"type":"object","properties":{"___endpoints":{"minItems":1,"type":"array","items":{"$ref":"#\/endpoint\/properties\/name"}},"___pattern":{"type":"string"}},"required":["endpoints","pattern"]}}},"___additionalProperties":false,"___required":["cells","rules"],"___cells":{"type":"array","items":{"$fref":"common.json#\/cell"}}}},"___command":{"type":"string"},"___affinity_limits":{"additionalProperties":false,"type":"object","properties":{"___pod":{"$eref":{"type":"integer","minimum":1}},"___server":{"$eref":{"type":"integer","minimum":1}},"___rack":{"$eref":{"type":"integer","minimum":1}},"___required":[]}},"___data_retention_timeout":{"$fref":"common.json#\/time_interval"},"___archive":{"type":"array","items":{"type":"string"}}}},"service":{"additionalProperties":false,"type":"object","properties":{"___name":{"pattern":"^[\\w\\-\\.]+$","type":"string","maxLength":60},"___restart":{"additionalProperties":false,"type":"object","properties":{"___interval":{"maximum":600,"type":"integer","minimum":30},"___limit":{"maximum":10,"type":"integer","minimum":0}},"required":["limit"]},"___command":{"type":"string"},"___root":{"type":"boolean"}},"required":["name","command"]},"limit":{"type":"integer","minimum":1},"resource_id":{"$fref":"common.json#\/app_id"},"vring_rule":{"type":"object","properties":{"___endpoints":{"minItems":1,"type":"array","items":{"$eref":{"$ref":"common.json#\/endpoint"}}},"___pattern":{"type":"string"}},"required":["endpoints","pattern"]},"verbs":{"create":{"allOf":[{"required":["memory","cpu","disk"]},{"anyOf":[{"required":["services"]},{"required":["image"]}]}]},"update":{"required":[]}},"ephemeral_ports":{"additionalProperties":false,"type":"object","properties":{"___tcp":{"maximum":255,"type":"integer","minimum":0},"___udp":{"maximum":255,"type":"integer","minimum":0}}},"environ":{"additionalProperties":false,"type":"object","properties":{"___name":{"type":"string"},"___value":{"type":"string"}},"required":["name","value"]}}