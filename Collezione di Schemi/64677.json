{"allOf":[{"$eref":{"patternProperties":{"___^[a-z0-9_]{2,250}$":{"anyOf":[{"minItems":1,"type":"array"},{"type":"string"},{"type":"integer"},{"type":"boolean"},{"type":"number"},{"type":"object"}]},"___^[a-z0-9_]{0,246}_bin$":{"$ref":"..\/common\/binary.json"}},"$schema":"http:\/\/json-schema.org\/draft-07\/schema#","description":"Common properties and behavior across all Cyber Observable Objects.","additionalProperties":false,"title":"cyber-observable-core","type":"object","properties":{"___extensions":{"description":"Specifies any extensions of the object, as a dictionary.","$ref":"..\/common\/dictionary.json"},"___type":{"not":{"enum":["action"]},"minLength":3,"pattern":"^\\-?[a-z0-9]+(-[a-z0-9]+)*\\-?$","description":"Indicates that this object is an Observable Object. The value of this property MUST be a valid Observable Object type name, but to allow for custom objects this has been removed from the schema.","type":"string","maxLength":250},"___granular_markings":{"minItems":1,"description":"The set of granular markings that apply to this object.","type":"array","items":{"$ref":"..\/common\/granular-marking.json"}},"___is_defanged":{"description":"Defines whether or not the data contained within the object has been defanged.","type":"boolean"},"___object_marking_refs":{"minItems":1,"description":"The list of marking-definition objects to be applied to this object.","type":"array","items":{"$ref":"..\/common\/identifier.json"}},"___spec_version":{"description":"The version of the STIX specification used to represent the content in this cyber-observable.","type":"string","enum":["2.0","2.1"]},"___id":{"description":"Specifies the identifier of the observable object, as a string.","$ref":"..\/common\/identifier.json"}},"required":["type","id"],"$id":"http:\/\/raw.githubusercontent.com\/oasis-open\/cti-stix2-json-schemas\/stix2.1\/schemas\/common\/cyber-observable-core.json"}},{"properties":{"___hashes":{"$eref":{"patternProperties":{"___^SSDEEP$":{"pattern":"^[a-zA-Z0-9\/+:.]{1,128}$","description":"Specifies the ssdeep fuzzy hashing algorithm.","type":"string"},"___^SHA3-512$":{"pattern":"^[a-fA-F0-9]{128}$","description":"Specifies the SHA3-512 cryptographic hash function.","type":"string"},"___^SHA-512$":{"pattern":"^[a-fA-F0-9]{128}$","description":"Specifies the SHA-­512 cryptographic hash function (part of the SHA­2 family).","type":"string"},"___^SHA-1$":{"pattern":"^[a-fA-F0-9]{40}$","description":"Specifies the SHA­-1 (secure-­hash algorithm 1) cryptographic hash function.","type":"string"},"___^TLSH$":{"pattern":"^[a-zA-Z0-9]{70}$","description":"Specifies the TLSH locality-sensitive hashing algorithm.","type":"string"},"___^MD5$":{"pattern":"^[a-fA-F0-9]{32}$","description":"Specifies the MD5 message digest algorithm.","type":"string"},"___^SHA-256$":{"pattern":"^[a-fA-F0-9]{64}$","description":"Specifies the SHA-­256 cryptographic hash function (part of the SHA­2 family).","type":"string"},"___^SHA3-256$":{"pattern":"^[a-fA-F0-9]{64}$","description":"Specifies the SHA3-256 cryptographic hash function.","type":"string"},"___^[a-zA-Z0-9_-]{3,250}$":{"description":"Custom hash key","type":"string"}},"allOf":[{"$ref":"..\/common\/dictionary.json"}],"$schema":"http:\/\/json-schema.org\/draft-07\/schema#","description":"The Hashes type represents one or more cryptographic hashes, as a special set of key\/value pairs","additionalProperties":false,"title":"hashes","$id":"http:\/\/raw.githubusercontent.com\/oasis-open\/cti-stix2-json-schemas\/stix2.1\/schemas\/common\/hashes-type.json"},"description":"Specifies a dictionary of hashes for the contents of the url or the payload_bin.  This MUST be provided when the url property is present."},"___decryption_key":{"description":"Specifies the decryption key for the encrypted binary data (either via payload_bin or url).","type":"string"},"___type":{"description":"The value of this property MUST be `artifact`.","type":"string","enum":["artifact"]},"___url":{"$eref":{"$schema":"http:\/\/json-schema.org\/draft-07\/schema#","pattern":"^([a-zA-Z][a-zA-Z0-9+.-]*):(?:\\\/\\\/((?:(?=((?:[a-zA-Z0-9-._~!$&'()*+,;=:]|%[0-9a-fA-F]{2})*))(\\3)@)?(?=((?:\\[?(?:::[a-fA-F0-9]+(?::[a-fA-F0-9]+)?|(?:[a-fA-F0-9]+:)+(?::[a-fA-F0-9]+)+|(?:[a-fA-F0-9]+:)+(?::|(?:[a-fA-F0-9]+:?)*))\\]?)|(?:[a-zA-Z0-9-._~!$&'()*+,;=]|%[0-9a-fA-F]{2})*))\\5(?::(?=(\\d*))\\6)?)(\\\/(?=((?:[a-zA-Z0-9-._~!$&'()*+,;=:@\\\/]|%[0-9a-fA-F]{2})*))\\8)?|(\\\/?(?!\\\/)(?=((?:[a-zA-Z0-9-._~!$&'()*+,;=:@\\\/]|%[0-9a-fA-F]{2})*))\\10)?)(?:\\?(?=((?:[a-zA-Z0-9-._~!$&'()*+,;=:@\\\/?]|%[0-9a-fA-F]{2})*))\\11)?(?:#(?=((?:[a-zA-Z0-9-._~!$&'()*+,;=:@\\\/?]|%[0-9a-fA-F]{2})*))\\12)?$","description":"Matches the elements of a URL using a regular expression.","title":"url-regex","type":"string","$id":"http:\/\/raw.githubusercontent.com\/oasis-open\/cti-stix2-json-schemas\/stix2.1\/schemas\/common\/url-regex.json"},"description":"The value of this property MUST be a valid URL that resolves to the unencoded content."},"___encryption_algorithm":{"$eref":{"type":"string","enum":["AES-256-GCM","ChaCha20-Poly1305","mime-type-indicated"]},"description":"If the artifact is encrypted, specifies the type of encryption algorithm the binary data  (either via payload_bin or url) is encoded in."},"___mime_type":{"pattern":"^(application|audio|font|image|message|model|multipart|text|video)\/[a-zA-Z0-9.+_-]+","description":"The value of this property MUST be a valid MIME type as specified in the IANA Media Types registry.","type":"string"},"___payload_bin":{"$eref":{"$schema":"http:\/\/json-schema.org\/draft-07\/schema#","pattern":"^([A-Za-z0-9+\/]{4})*([A-Za-z0-9+\/]{4}|[A-Za-z0-9+\/]{3}=|[A-Za-z0-9+\/]{2}==)$","description":"The \u200Bbinary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648\u200B. Other serializations SHOULD use a native binary type, if available.","title":"binary","type":"string","$id":"http:\/\/raw.githubusercontent.com\/oasis-open\/cti-stix2-json-schemas\/stix2.1\/schemas\/common\/binary.json"},"description":"Specifies the binary data contained in the artifact as a base64-encoded string."},"___id":{"pattern":"^artifact--","title":"id"}}},{"oneOf":[{"not":{"required":["url"]},"required":["payload_bin"]},{"not":{"required":["payload_bin"]},"required":["url","hashes"]}]},{"oneOf":[{"not":{"required":["decryption_key"]},"required":["encryption_algorithm"]},{"required":["encryption_algorithm","decryption_key"]},{"allOf":[{"not":{"required":["encryption_algorithm"]}},{"not":{"required":["decryption_key"]}}]}]}],"$schema":"http:\/\/json-schema.org\/draft-07\/schema#","description":"The Artifact Object permits capturing an array of bytes (8-bits), as a base64-encoded string string, or linking to a file-like payload.","title":"artifact","type":"object","definitions":{"_88encryption-algorithm-enum":{"type":"string","enum":["AES-256-GCM","ChaCha20-Poly1305","mime-type-indicated"]}},"$id":"http:\/\/raw.githubusercontent.com\/oasis-open\/cti-stix2-json-schemas\/stix2.1\/schemas\/observables\/artifact.json"}