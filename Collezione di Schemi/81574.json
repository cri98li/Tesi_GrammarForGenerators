{"oneOf":[{"title":"Route rule","required":["route"]},{"title":"Action rule","required":["actions"]}],"additionalFields":false,"$schema":"http:\/\/json-schema.org\/draft-04\/schema#","title":"Rule","type":"object","definitions":{"_88delayAction":{"allOf":[{"$eref":{"description":"Action to apply to matching requests","title":"Action","type":"object","properties":{"___action":{"type":"string"}},"required":["action"]}}],"description":"Conditionally delay the request","additionalProperties":false,"title":"Delay","properties":{"___action":{"enum":["delay"]},"___tags":{"$eref":{"minItems":1,"uniqueItems":true,"description":"An array of one or more unique service tags.","title":"Tags","type":"array","items":{"type":"string"}}},"___probability":{"$eref":{"default":1,"description":"Probability of executing action","maximum":1,"exclusiveMinimum":true,"title":"Probability","type":"number","minimum":0}},"___duration":{"description":"Duration of delay in seconds","type":"number","exclusiveMinimum":true,"minimum":0}},"required":["duration"]},"_88probability":{"default":1,"description":"Probability of executing action","maximum":1,"exclusiveMinimum":true,"title":"Probability","type":"number","minimum":0},"_88tags":{"minItems":1,"uniqueItems":true,"description":"An array of one or more unique service tags.","title":"Tags","type":"array","items":{"type":"string"}},"_88headers":{"description":"Header key\/value pairs","additionalProperties":{"title":"Header","type":"string"},"title":"Headers","type":"object","minProperties":1},"_88abortAction":{"allOf":[{"$eref":{"description":"Action to apply to matching requests","title":"Action","type":"object","properties":{"___action":{"type":"string"}},"required":["action"]}}],"description":"Conditionally abort the request","additionalProperties":false,"title":"Abort","properties":{"___action":{"enum":["abort"]},"___tags":{"$eref":{"minItems":1,"uniqueItems":true,"description":"An array of one or more unique service tags.","title":"Tags","type":"array","items":{"type":"string"}}},"___return_code":{"description":"Return code","maximum":599,"type":"number","minimum":-5},"___probability":{"$eref":{"default":1,"description":"Probability of executing action","maximum":1,"exclusiveMinimum":true,"title":"Probability","type":"number","minimum":0}}},"required":["return_code"]},"_88action":{"description":"Action to apply to matching requests","title":"Action","type":"object","properties":{"___action":{"type":"string"}},"required":["action"]},"_88basicBackend":{"description":"Basic backend to route to","additionalProperties":false,"title":"Basic Backend","type":"object","properties":{"___name":{"description":"The service name","title":"Service name","type":"string"},"___tags":{"$eref":{"minItems":1,"uniqueItems":true,"description":"An array of one or more unique service tags.","title":"Tags","type":"array","items":{"type":"string"}}}},"required":["tags"]},"_88traceAction":{"allOf":[{"$eref":{"description":"Action to apply to matching requests","title":"Action","type":"object","properties":{"___action":{"type":"string"}},"required":["action"]}}],"description":"Trace request","additionalProperties":false,"title":"Trace","properties":{"___log_value":{"type":"string"},"___action":{"enum":["trace"]},"___tags":{"$eref":{"minItems":1,"uniqueItems":true,"description":"An array of one or more unique service tags.","title":"Tags","type":"array","items":{"type":"string"}}},"___log_key":{"default":"trace","type":"string"}}},"_88route":{"additionalProperties":false,"type":"object","properties":{"___backends":{"minItems":1,"type":"array","items":{"$eref":{"description":"Backend to route to","additionalProperties":false,"title":"Backend","type":"object","properties":{"___name":{"description":"The service name","title":"Service name","type":"string"},"___weight":{"default":1,"description":"Percentage of traffic to route to this backend.","maximum":1,"exclusiveMinimum":true,"title":"Traffic weight","type":"number","minimum":0},"___tags":{"$ref":"#\/definitions\/tags"},"___timeout":{"description":"Request timeout or read\/write timeout on the pipe in seconds","type":"number","exclusiveMinimum":true,"minimum":0}},"required":["tags"]}}}},"required":["backends"]},"_88backend":{"description":"Backend to route to","additionalProperties":false,"title":"Backend","type":"object","properties":{"___name":{"description":"The service name","title":"Service name","type":"string"},"___weight":{"default":1,"description":"Percentage of traffic to route to this backend.","maximum":1,"exclusiveMinimum":true,"title":"Traffic weight","type":"number","minimum":0},"___tags":{"$eref":{"minItems":1,"uniqueItems":true,"description":"An array of one or more unique service tags.","title":"Tags","type":"array","items":{"type":"string"}}},"___timeout":{"description":"Request timeout or read\/write timeout on the pipe in seconds","type":"number","exclusiveMinimum":true,"minimum":0}},"required":["tags"]},"_88source":{"description":"Microservice where request originated from","additionalProperties":false,"title":"Source","type":"object","properties":{"___name":{"type":"string"},"___tags":{"$eref":{"minItems":1,"uniqueItems":true,"description":"An array of one or more unique service tags.","title":"Tags","type":"array","items":{"type":"string"}}}},"required":["name"]},"_88match":{"description":"Conditions that must be true to apply the action or routing","additionalProperties":false,"title":"Match","type":"object","properties":{"___headers":{"$eref":{"description":"Header key\/value pairs","additionalProperties":{"title":"Header","type":"string"},"title":"Headers","type":"object","minProperties":1}},"___source":{"$eref":{"description":"Microservice where request originated from","additionalProperties":false,"title":"Source","type":"object","properties":{"___name":{"type":"string"},"___tags":{"$ref":"#\/definitions\/tags"}},"required":["name"]}}},"minProperties":1}},"properties":{"___destination":{"type":"string"},"___tags":{"type":"array","items":{"type":"string"}},"___actions":{"minItems":1,"type":"array","items":{"anyOf":[{"$eref":{"allOf":[{"$ref":"#\/definitions\/action"}],"description":"Conditionally delay the request","additionalProperties":false,"title":"Delay","properties":{"___action":{"enum":["delay"]},"___tags":{"$ref":"#\/definitions\/tags"},"___probability":{"$ref":"#\/definitions\/probability"},"___duration":{"description":"Duration of delay in seconds","type":"number","exclusiveMinimum":true,"minimum":0}},"required":["duration"]}},{"$eref":{"allOf":[{"$ref":"#\/definitions\/action"}],"description":"Conditionally abort the request","additionalProperties":false,"title":"Abort","properties":{"___action":{"enum":["abort"]},"___tags":{"$ref":"#\/definitions\/tags"},"___return_code":{"description":"Return code","maximum":599,"type":"number","minimum":-5},"___probability":{"$ref":"#\/definitions\/probability"}},"required":["return_code"]}},{"$eref":{"allOf":[{"$ref":"#\/definitions\/action"}],"description":"Trace request","additionalProperties":false,"title":"Trace","properties":{"___log_value":{"type":"string"},"___action":{"enum":["trace"]},"___tags":{"$ref":"#\/definitions\/tags"},"___log_key":{"default":"trace","type":"string"}}}}]}},"___route":{"$eref":{"additionalProperties":false,"type":"object","properties":{"___backends":{"minItems":1,"type":"array","items":{"$ref":"#\/definitions\/backend"}}},"required":["backends"]}},"___id":{"type":"string"},"___priority":{"default":0,"type":"number"},"___match":{"additionalProperties":false,"type":"object","properties":{"___all":{"minItems":1,"type":"array","items":{"$eref":{"description":"Conditions that must be true to apply the action or routing","additionalProperties":false,"title":"Match","type":"object","properties":{"___headers":{"$ref":"#\/definitions\/headers"},"___source":{"$ref":"#\/definitions\/source"}},"minProperties":1}}},"___headers":{"$eref":{"description":"Header key\/value pairs","additionalProperties":{"title":"Header","type":"string"},"title":"Headers","type":"object","minProperties":1}},"___none":{"minItems":1,"type":"array","items":{"$eref":{"description":"Conditions that must be true to apply the action or routing","additionalProperties":false,"title":"Match","type":"object","properties":{"___headers":{"$ref":"#\/definitions\/headers"},"___source":{"$ref":"#\/definitions\/source"}},"minProperties":1}}},"___any":{"minItems":1,"type":"array","items":{"$eref":{"description":"Conditions that must be true to apply the action or routing","additionalProperties":false,"title":"Match","type":"object","properties":{"___headers":{"$ref":"#\/definitions\/headers"},"___source":{"$ref":"#\/definitions\/source"}},"minProperties":1}}},"___source":{"$eref":{"description":"Microservice where request originated from","additionalProperties":false,"title":"Source","type":"object","properties":{"___name":{"type":"string"},"___tags":{"$ref":"#\/definitions\/tags"}},"required":["name"]}}},"minProperties":1}},"required":["destination"]}