{"allOf":[{"$eref":{"patternProperties":{"___^[a-z0-9_]{2,250}$":{"anyOf":[{"minItems":1,"type":"array"},{"type":"string"},{"type":"integer"},{"type":"boolean"},{"type":"number"},{"type":"object"}]},"___^[a-z0-9_]{0,246}_bin$":{"$ref":"..\/common\/binary.json"}},"$schema":"http:\/\/json-schema.org\/draft-07\/schema#","description":"Common properties and behavior across all Cyber Observable Objects.","additionalProperties":false,"title":"cyber-observable-core","type":"object","properties":{"___extensions":{"description":"Specifies any extensions of the object, as a dictionary.","$ref":"..\/common\/dictionary.json"},"___type":{"not":{"enum":["action"]},"minLength":3,"pattern":"^\\-?[a-z0-9]+(-[a-z0-9]+)*\\-?$","description":"Indicates that this object is an Observable Object. The value of this property MUST be a valid Observable Object type name, but to allow for custom objects this has been removed from the schema.","type":"string","maxLength":250},"___granular_markings":{"minItems":1,"description":"The set of granular markings that apply to this object.","type":"array","items":{"$ref":"..\/common\/granular-marking.json"}},"___is_defanged":{"description":"Defines whether or not the data contained within the object has been defanged.","type":"boolean"},"___object_marking_refs":{"minItems":1,"description":"The list of marking-definition objects to be applied to this object.","type":"array","items":{"$ref":"..\/common\/identifier.json"}},"___spec_version":{"description":"The version of the STIX specification used to represent the content in this cyber-observable.","type":"string","enum":["2.0","2.1"]},"___id":{"description":"Specifies the identifier of the observable object, as a string.","$ref":"..\/common\/identifier.json"}},"required":["type","id"],"$id":"http:\/\/raw.githubusercontent.com\/oasis-open\/cti-stix2-json-schemas\/stix2.1\/schemas\/common\/cyber-observable-core.json"}},{"properties":{"___is_hidden":{"description":"Specifies whether the process is hidden.","type":"boolean"},"___extensions":{"$eref":{"patternProperties":{"___^windows-process-ext$":{"allOf":[{"properties":{"___aslr_enabled":{"description":"Specifies whether Address Space Layout Randomization (ASLR) is enabled for the process.","type":"boolean"},"___integrity_level":{"description":"Specifies the Windows integrity level, or trustworthiness, of the process.","$ref":"#\/definitions\/windows-integrity-level-enum"},"___window_title":{"description":"Specifies the title of the main window of the process.","type":"string"},"___dep_enabled":{"description":"Specifies whether Data Execution Prevention (DEP) is enabled for the process.","type":"boolean"},"___owner_sid":{"description":"Specifies the Security ID (SID) value of the owner of the process.","type":"string"},"___startup_info":{"description":"Specifies the STARTUP_INFO struct used by the process, as a dictionary.","$ref":"#\/definitions\/startup-info-dictionary"},"___priority":{"description":"Specifies the current priority class of the process in Windows.","type":"string"}}},{"anyOf":[{"required":["aslr_enabled"]},{"required":["dep_enabled"]},{"required":["priority"]},{"required":["owner_sid"]},{"required":["window_title"]},{"required":["startup_info"]}]}],"description":"The Windows Process extension specifies a default extension for capturing properties specific to Windows processes.","type":"object"},"___^windows-service-ext$":{"description":"The Windows Service extension specifies a default extension for capturing properties specific to Windows services.","anyOf":[{"required":["service_name"]},{"required":["descriptions"]},{"required":["display_name"]},{"required":["group_name"]},{"required":["start_type"]},{"required":["service_dll_refs"]},{"required":["service_type"]},{"required":["service_status"]}],"type":"object","properties":{"___service_status":{"description":"Specifies the current status of the service. windows-service-status-enum","type":"string","enum":["SERVICE_CONTINUE_PENDING","SERVICE_PAUSE_PENDING","SERVICE_PAUSED","SERVICE_RUNNING","SERVICE_START_PENDING","SERVICE_STOP_PENDING","SERVICE_STOPPED"]},"___start_type":{"description":"Specifies the start options defined for the service. windows-service-start-enum","type":"string","enum":["SERVICE_AUTO_START","SERVICE_BOOT_START","SERVICE_DEMAND_START","SERVICE_DISABLED","SERVICE_SYSTEM_ALERT"]},"___service_dll_refs":{"minItems":1,"description":"Specifies the DLLs loaded by the service, as a reference to one or more File Objects.","type":"array","items":{"type":"string"}},"___descriptions":{"minItems":1,"description":"Specifies the descriptions defined for the service.","type":"array","items":{"type":"string"}},"___group_name":{"description":"Specifies the name of the load ordering group of which the service is a member.","type":"string"},"___service_type":{"description":"Specifies the type of the service. windows-service-enum","type":"string","enum":["SERVICE_KERNEL_DRIVER","SERVICE_FILE_SYSTEM_DRIVER","SERVICE_WIN32_OWN_PROCESS","SERVICE_WIN32_SHARE_PROCESS"]},"___service_name":{"description":"Specifies the name of the service.","type":"string"},"___display_name":{"description":"Specifies the displayed name of the service in Windows GUI controls.","type":"string"}}}},"allOf":[{"$ref":"..\/common\/dictionary.json"}],"additionalProperties":{"description":"Custom file extension","$ref":"..\/common\/dictionary.json"}},"description":"The Process Object defines the following extensions. In addition to these, producers MAY create their own. Extensions: windows-process-ext, windows-service-ext."},"___parent_ref":{"description":"Specifies the other process that spawned (i.e. is the parent of) this one, as represented by a Process Object.","type":"string"},"___type":{"description":"The value of this property MUST be `process`.","type":"string","enum":["process"]},"___image_ref":{"description":"Specifies the executable binary that was executed as the process image, as a reference to a File Object.","type":"string"},"___opened_connection_refs":{"minItems":1,"description":"Specifies the list of network connections opened by the process, as a reference to one or more Network Traffic Objects.","type":"array","items":{"type":"string"}},"___child_refs":{"minItems":1,"description":"Specifies the other processes that were spawned by (i.e. children of) this process, as a reference to one or more other Process Objects.","type":"array","items":{"type":"string"}},"___created":{"$eref":{"$schema":"http:\/\/json-schema.org\/draft-07\/schema#","pattern":"^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?Z$","description":"Represents timestamps across the CTI specifications. The format is an RFC3339 timestamp, with a required timezone specification of 'Z'.","title":"timestamp","type":"string","$id":"http:\/\/raw.githubusercontent.com\/oasis-open\/cti-stix2-json-schemas\/stix2.1\/schemas\/common\/timestamp.json"},"description":"Specifies the date\/time at which the process was created."},"___pid":{"description":"Specifies the Process ID, or PID, of the process.","type":"integer"},"___cwd":{"description":"Specifies the current working directory of the process.","type":"string"},"___command_line":{"description":"Specifies the full command line used in executing the process, including the process name (which may be specified individually via the binary_ref.name property) and any arguments.","type":"string"},"___environment_variables":{"$eref":{"patternProperties":{"___^[a-zA-Z0-9_-]{0,250}$":{"anyOf":[{"minItems":1,"type":"array"},{"type":"string"},{"type":"integer"},{"type":"boolean"},{"type":"number"},{"type":"object"}]}},"$schema":"http:\/\/json-schema.org\/draft-07\/schema#","description":"A dictionary captures a set of key\/value pairs","title":"dictionary","type":"object","addtionalProperties":false,"$id":"http:\/\/raw.githubusercontent.com\/oasis-open\/cti-stix2-json-schemas\/stix2.1\/schemas\/common\/dictionary.json","minProperties":1},"description":"Specifies the list of environment variables associated with the process as a dictionary."},"___id":{"pattern":"^process--","title":"id"},"___creator_user_ref":{"description":"Specifies the user that created the process, as a reference to a User Account Object.","type":"string"}}}],"$schema":"http:\/\/json-schema.org\/draft-07\/schema#","description":"The Process Object represents common properties of an instance of a computer program as executed on an operating system.","anyOf":[{"required":["extensions"]},{"required":["is_hidden"]},{"required":["pid"]},{"required":["name"]},{"required":["created"]},{"required":["cwd"]},{"required":["arguments"]},{"required":["command_line"]},{"required":["environment_variables"]},{"required":["opened_connection_refs"]},{"required":["creator_user_ref"]},{"required":["image_ref"]},{"required":["parent_ref"]},{"required":["child_refs"]}],"title":"process","type":"object","definitions":{"_88process-extensions-dictionary":{"patternProperties":{"___^windows-process-ext$":{"allOf":[{"properties":{"___aslr_enabled":{"description":"Specifies whether Address Space Layout Randomization (ASLR) is enabled for the process.","type":"boolean"},"___integrity_level":{"$eref":{"type":"string","enum":["low","medium","high","system"]},"description":"Specifies the Windows integrity level, or trustworthiness, of the process."},"___window_title":{"description":"Specifies the title of the main window of the process.","type":"string"},"___dep_enabled":{"description":"Specifies whether Data Execution Prevention (DEP) is enabled for the process.","type":"boolean"},"___owner_sid":{"description":"Specifies the Security ID (SID) value of the owner of the process.","type":"string"},"___startup_info":{"$eref":{"patternProperties":{"___^lpReserved|lpReserved2$":{"type":"null"},"___^cb|dwX|dwY|dwXSize|dwYSize|dwXCountChars|dwYCountChars$":{"type":"integer"},"___^cbReserved2$":{"maximum":0,"type":"integer","minimum":0},"___^lpDesktop|lpTitle|dwFillAttribute|dwFlags|wShowWindow|hStdInput|hStdOutput|hStdError$":{"type":"string"}},"allOf":[{"$ref":"..\/common\/dictionary.json"}],"additionalProperties":false},"description":"Specifies the STARTUP_INFO struct used by the process, as a dictionary."},"___priority":{"description":"Specifies the current priority class of the process in Windows.","type":"string"}}},{"anyOf":[{"required":["aslr_enabled"]},{"required":["dep_enabled"]},{"required":["priority"]},{"required":["owner_sid"]},{"required":["window_title"]},{"required":["startup_info"]}]}],"description":"The Windows Process extension specifies a default extension for capturing properties specific to Windows processes.","type":"object"},"___^windows-service-ext$":{"description":"The Windows Service extension specifies a default extension for capturing properties specific to Windows services.","anyOf":[{"required":["service_name"]},{"required":["descriptions"]},{"required":["display_name"]},{"required":["group_name"]},{"required":["start_type"]},{"required":["service_dll_refs"]},{"required":["service_type"]},{"required":["service_status"]}],"type":"object","properties":{"___service_status":{"description":"Specifies the current status of the service. windows-service-status-enum","type":"string","enum":["SERVICE_CONTINUE_PENDING","SERVICE_PAUSE_PENDING","SERVICE_PAUSED","SERVICE_RUNNING","SERVICE_START_PENDING","SERVICE_STOP_PENDING","SERVICE_STOPPED"]},"___start_type":{"description":"Specifies the start options defined for the service. windows-service-start-enum","type":"string","enum":["SERVICE_AUTO_START","SERVICE_BOOT_START","SERVICE_DEMAND_START","SERVICE_DISABLED","SERVICE_SYSTEM_ALERT"]},"___service_dll_refs":{"minItems":1,"description":"Specifies the DLLs loaded by the service, as a reference to one or more File Objects.","type":"array","items":{"type":"string"}},"___descriptions":{"minItems":1,"description":"Specifies the descriptions defined for the service.","type":"array","items":{"type":"string"}},"___group_name":{"description":"Specifies the name of the load ordering group of which the service is a member.","type":"string"},"___service_type":{"description":"Specifies the type of the service. windows-service-enum","type":"string","enum":["SERVICE_KERNEL_DRIVER","SERVICE_FILE_SYSTEM_DRIVER","SERVICE_WIN32_OWN_PROCESS","SERVICE_WIN32_SHARE_PROCESS"]},"___service_name":{"description":"Specifies the name of the service.","type":"string"},"___display_name":{"description":"Specifies the displayed name of the service in Windows GUI controls.","type":"string"}}}},"allOf":[{"$eref":{"patternProperties":{"___^[a-zA-Z0-9_-]{0,250}$":{"anyOf":[{"minItems":1,"type":"array"},{"type":"string"},{"type":"integer"},{"type":"boolean"},{"type":"number"},{"type":"object"}]}},"$schema":"http:\/\/json-schema.org\/draft-07\/schema#","description":"A dictionary captures a set of key\/value pairs","title":"dictionary","type":"object","addtionalProperties":false,"$id":"http:\/\/raw.githubusercontent.com\/oasis-open\/cti-stix2-json-schemas\/stix2.1\/schemas\/common\/dictionary.json","minProperties":1}}],"additionalProperties":{"$eref":{"patternProperties":{"___^[a-zA-Z0-9_-]{0,250}$":{"anyOf":[{"minItems":1,"type":"array"},{"type":"string"},{"type":"integer"},{"type":"boolean"},{"type":"number"},{"type":"object"}]}},"$schema":"http:\/\/json-schema.org\/draft-07\/schema#","description":"A dictionary captures a set of key\/value pairs","title":"dictionary","type":"object","addtionalProperties":false,"$id":"http:\/\/raw.githubusercontent.com\/oasis-open\/cti-stix2-json-schemas\/stix2.1\/schemas\/common\/dictionary.json","minProperties":1},"description":"Custom file extension"}},"_88windows-integrity-level-enum":{"type":"string","enum":["low","medium","high","system"]},"_88startup-info-dictionary":{"patternProperties":{"___^lpReserved|lpReserved2$":{"type":"null"},"___^cb|dwX|dwY|dwXSize|dwYSize|dwXCountChars|dwYCountChars$":{"type":"integer"},"___^cbReserved2$":{"maximum":0,"type":"integer","minimum":0},"___^lpDesktop|lpTitle|dwFillAttribute|dwFlags|wShowWindow|hStdInput|hStdOutput|hStdError$":{"type":"string"}},"allOf":[{"$eref":{"patternProperties":{"___^[a-zA-Z0-9_-]{0,250}$":{"anyOf":[{"minItems":1,"type":"array"},{"type":"string"},{"type":"integer"},{"type":"boolean"},{"type":"number"},{"type":"object"}]}},"$schema":"http:\/\/json-schema.org\/draft-07\/schema#","description":"A dictionary captures a set of key\/value pairs","title":"dictionary","type":"object","addtionalProperties":false,"$id":"http:\/\/raw.githubusercontent.com\/oasis-open\/cti-stix2-json-schemas\/stix2.1\/schemas\/common\/dictionary.json","minProperties":1}}],"additionalProperties":false}},"$id":"http:\/\/raw.githubusercontent.com\/oasis-open\/cti-stix2-json-schemas\/stix2.1\/schemas\/observables\/process.json"}