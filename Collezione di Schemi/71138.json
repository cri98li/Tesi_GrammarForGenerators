{"outputs":{"WebHookURI":{"type":"string","value":"[listCallbackURL(concat(resourceId('Microsoft.Logic\/workflows\/', parameters('logicAppName')), '\/triggers\/manual'), '2016-06-01').value]"}},"variables":{},"$schema":"https:\/\/schema.management.azure.com\/schemas\/2015-01-01\/deploymentTemplate.json#","resources":[{"apiVersion":"2016-06-01","name":"[parameters('twilioConnectionName')]","location":"[parameters('location')]","type":"Microsoft.Web\/connections","properties":{"___api":{"id":"[concat(subscription().id,'\/providers\/Microsoft.Web\/locations\/', parameters('location'), '\/managedApis\/twilio')]"},"___displayName":"twilio","___parameterValues":{"sid":"[parameters('twilioSid')]","token":"[parameters('twilioToken')]"}}},{"apiVersion":"2016-06-01","dependsOn":["[resourceId('Microsoft.Web\/connections', parameters('twilioConnectionName'))]"],"name":"[parameters('logicAppName')]","location":"[parameters('location')]","type":"Microsoft.Logic\/workflows","properties":{"___definition":{"outputs":{},"$schema":"https:\/\/schema.management.azure.com\/providers\/Microsoft.Logic\/schemas\/2016-06-01\/workflowdefinition.json#","triggers":{"manual":{"kind":"Http","inputs":{"schema":{"$schema":"http:\/\/json-schema.org\/draft-04\/schema#","type":"object","properties":{"___status":{"type":"string"},"___context":{"type":"object","properties":{"___name":{"type":"string"},"___resourceName":{"type":"string"},"___portalLink":{"type":"string"}},"required":["name","portalLink","resourceName"]}},"required":["status","context"]}},"type":"request"}},"contentVersion":"1.0.0.0","actions":{"Send_Message":{"inputs":{"path":"\/Messages.json","method":"post","host":{"connection":{"name":"@parameters('$connections')['twilio']['connectionId']"}},"body":{"from":"[parameters('twilioAccountNumber')]","to":"[parameters('toPhoneNumber')]","body":"Azure Alert - '@{triggerBody()['context']['name']}' @{triggerBody()['status']} on '@{triggerBody()['context']['resourceName']}'. Details: @{body('Http')['id']}"}},"runAfter":{"Http":["Succeeded"]},"type":"ApiConnection"},"Http":{"inputs":{"headers":{"Content-Type":"application\/json"},"method":"POST","body":{"longUrl":"@{triggerBody()['context']['portalLink']}"},"uri":"https:\/\/www.googleapis.com\/urlshortener\/v1\/url?key=AIzaSyBkT1BRbA-uULHz8HMUAi0ywJtpNLXHShI"},"runAfter":{},"type":"Http"}},"parameters":{"$connections":{"defaultValue":{},"type":"Object"}}},"___parameters":{"$connections":{"value":{"twilio":{"connectionId":"[resourceId('Microsoft.Web\/connections', parameters('twilioConnectionName'))]","id":"[concat(subscription().id,'\/providers\/Microsoft.Web\/locations\/', parameters('location'), '\/managedApis\/twilio')]"}}}}}}],"contentVersion":"1.0.0.0","parameters":{"twilioSid":{"metadata":{"description":"Your Twilio SID."},"type":"securestring"},"twilioAccountNumber":{"metadata":{"description":"The Twilio number the message will send from."},"type":"string"},"toPhoneNumber":{"metadata":{"description":"The phone number the message will send to."},"type":"string"},"location":{"metadata":{"description":"Location for all resources."},"defaultValue":"[resourceGroup().location]","type":"string"},"twilioToken":{"metadata":{"description":"Your Twilio AuthToken."},"type":"securestring"},"twilioConnectionName":{"metadata":{"description":"The name for the Twilio connection."},"defaultValue":"TwilioConnection","type":"string"},"logicAppName":{"metadata":{"description":"The name for the logic app."},"type":"string"}}}