{"$schema":"http:\/\/json-schema.org\/draft-04\/schema#","additionalproperties":false,"title":"Configuration schema for aws_bootstrap script","type":"object","definitions":{"_88newrsakeypair":{"additioalProperties":false,"type":"object","properties":{"___private_key_has_passphrase":{"default":true,"description":"Use a passphrase to lock the private key. User will be prompted. Defaults to true","type":"boolean"},"___signature":{"default":{},"description":"Details to use to create a self signed certificate","type":"object","properties":{"___stateOrProvinceName":{"default":"New Jersey","type":"string"},"___serialNumber":{"default":"%%DATE_UTC_EPOCH%%","type":["integer","string"]},"___organizationUnit":{"default":"Stragtegic Information","type":"string"},"___countryName":{"default":"US","type":"string"},"___localityName":{"default":"Holland","type":"string"},"___organizationName":{"default":"Banzai Institue","type":"string"},"___domainComponent":{"default":"*","type":"string"}}},"___key_directory":{"default":"%%temporary_directory%%%%SEP%%\/keys","description":"The directory to put the key files","type":"string"},"___key_size":{"multipleOf":256,"default":2048,"description":"The key size in bits. Defaults to 2048","type":"number","minimum":1024},"___publickey_s3_bucket":{"default":"%%AWS_S3_DEFAULT_BUCKET%%","description":"The S3 bucket that the source code for the web application will be uploaded to","type":"string"},"___publickey_s3_bucket_region":{"default":"%%AWS_STACK_REGION%%","description":"The region the S3 bucket will be in","type":"string"},"___iam_server_certificate_name":{"default":"grr","description":"Full file path the the public key file","type":"string"},"___key_name_format":{"default":"grr_%%DATE%%","description":"The format of the key pair naming. Will product [key_name_format].pub and [key_name_format].pem","type":"string"},"___publickey_s3_key":{"default":"keys\/%%AWS_STACK_PREFIX%%_register%%AWS_STACK_POSTFIX%%.citybridge.com.email.pub","description":"The key in the sourcebundle_s3_bucket where the source bundle will be uploaded to. in the format \/path\/to\/file\/filename.zip","type":"string"}},"required":[]},"_88existingrsakeypair":{"additioalProperties":false,"type":"object","properties":{"___public_key_file_path":{"description":"Full file path the the public key file","type":"string"},"___publickey_s3_bucket":{"default":"%%AWS_S3_DEFAULT_BUCKET%%","description":"The S3 bucket that the source code for the web application will be uploaded to","type":"string"},"___X509_key_file_path":{"description":"Full file path the the signed certificate for this key","type":"string"},"___private_key_file_path":{"description":"Full file path the the private key file","type":"string"},"___no_passphrase":{"default":false,"description":"FOR TESTING ONLY. Don't prompt for a passphrase on unlocking private key. Private keys with a passphrase will fail if set to true. Deafults to false.","type":"boolean"},"___publickey_s3_bucket_region":{"default":"%%AWS_STACK_REGION%%","description":"The region the S3 bucket will be in","type":"string"},"___iam_server_certificate_name":{"description":"Full file path the the public key file","type":"string"},"___publickey_s3_key":{"default":"keys\/%%AWS_STACK_PREFIX%%_register%%AWS_STACK_POSTFIX%%.citybridge.com.email.pub","description":"The key in the sourcebundle_s3_bucket where the source bundle will be uploaded to. in the format \/path\/to\/file\/filename.zip","type":"string"}},"required":["public_key_file_path","private_key_file_path"]},"_88sourcebundle":{"default":{},"description":"Elastic Beanstalk function running globalreach_registration","type":"object","properties":{"___name":{"default":"%%AWS_STACK_PREFIX%%_grr_sourcebundle%%AWS_STACK_POSTFIX%%","description":"The name of the resource","type":"string"},"___sourcebundle_app_root":{"default":"%%PWD%%%%SEP%%","description":"The directory that is the top of the application on the file system. Defaults to pwd","type":"string"},"___sourcebundle_s3_bucket_region":{"default":"%%AWS_STACK_REGION%%","description":"The region the S3 bucket will be in","type":"string"},"___sourcebundle_files":{"default":[],"type":"array","items":{"type":"string"}},"___sourcebundle_s3_bucket":{"default":"%%AWS_S3_DEFAULT_BUCKET%%","description":"The S3 bucket that the source code for the web application will be uploaded to","type":"string"},"___sourcebundle_s3_key":{"default":"source\/%%AWS_STACK_PREFIX%%_register%%AWS_STACK_POSTFIX%%.citybridge.com.zip","description":"The key in the sourcebundle_s3_bucket where the source bundle will be uploaded to. in the format \/path\/to\/file\/filename.zip","type":"string"}}}},"properties":{"___AWS_STACK_PREFIX":{"default":"%%USERNAME%%","type":"string","descripton":"The name of the prefix to apply to the stack service and IAM names"},"___EMAIL_ENCRYPTION_KEY":{"default":{"_8_key_name_format":"%%AWS_STACK_NAME%%_grr_email","_8_iam_server_certificate_name":"%%AWS_STACK_NAME%%_grr_email"},"oneOf":[{"$eref":{"additioalProperties":false,"type":"object","properties":{"___public_key_file_path":{"description":"Full file path the the public key file","type":"string"},"___publickey_s3_bucket":{"default":"%%AWS_S3_DEFAULT_BUCKET%%","description":"The S3 bucket that the source code for the web application will be uploaded to","type":"string"},"___X509_key_file_path":{"description":"Full file path the the signed certificate for this key","type":"string"},"___private_key_file_path":{"description":"Full file path the the private key file","type":"string"},"___no_passphrase":{"default":false,"description":"FOR TESTING ONLY. Don't prompt for a passphrase on unlocking private key. Private keys with a passphrase will fail if set to true. Deafults to false.","type":"boolean"},"___publickey_s3_bucket_region":{"default":"%%AWS_STACK_REGION%%","description":"The region the S3 bucket will be in","type":"string"},"___iam_server_certificate_name":{"description":"Full file path the the public key file","type":"string"},"___publickey_s3_key":{"default":"keys\/%%AWS_STACK_PREFIX%%_register%%AWS_STACK_POSTFIX%%.citybridge.com.email.pub","description":"The key in the sourcebundle_s3_bucket where the source bundle will be uploaded to. in the format \/path\/to\/file\/filename.zip","type":"string"}},"required":["public_key_file_path","private_key_file_path"]}},{"$eref":{"additioalProperties":false,"type":"object","properties":{"___private_key_has_passphrase":{"default":true,"description":"Use a passphrase to lock the private key. User will be prompted. Defaults to true","type":"boolean"},"___signature":{"default":{},"description":"Details to use to create a self signed certificate","type":"object","properties":{"___stateOrProvinceName":{"default":"New Jersey","type":"string"},"___serialNumber":{"default":"%%DATE_UTC_EPOCH%%","type":["integer","string"]},"___organizationUnit":{"default":"Stragtegic Information","type":"string"},"___countryName":{"default":"US","type":"string"},"___localityName":{"default":"Holland","type":"string"},"___organizationName":{"default":"Banzai Institue","type":"string"},"___domainComponent":{"default":"*","type":"string"}}},"___key_directory":{"default":"%%temporary_directory%%%%SEP%%\/keys","description":"The directory to put the key files","type":"string"},"___key_size":{"multipleOf":256,"default":2048,"description":"The key size in bits. Defaults to 2048","type":"number","minimum":1024},"___publickey_s3_bucket":{"default":"%%AWS_S3_DEFAULT_BUCKET%%","description":"The S3 bucket that the source code for the web application will be uploaded to","type":"string"},"___publickey_s3_bucket_region":{"default":"%%AWS_STACK_REGION%%","description":"The region the S3 bucket will be in","type":"string"},"___iam_server_certificate_name":{"default":"grr","description":"Full file path the the public key file","type":"string"},"___key_name_format":{"default":"grr_%%DATE%%","description":"The format of the key pair naming. Will product [key_name_format].pub and [key_name_format].pem","type":"string"},"___publickey_s3_key":{"default":"keys\/%%AWS_STACK_PREFIX%%_register%%AWS_STACK_POSTFIX%%.citybridge.com.email.pub","description":"The key in the sourcebundle_s3_bucket where the source bundle will be uploaded to. in the format \/path\/to\/file\/filename.zip","type":"string"}},"required":[]}}],"description":"Infomration about the key pair used for encrypting and decrypting client details"},"___ALARM_EMAIL":{"description":"Email address to send message to if CloudWatch alarm fires. If unset CloudWatch alarms will not emmit an email","type":"string"},"___EXPANDED_CONFIG_FILE_OUTPUTFILE":{"default":"%%temporary_directory%%%%SEP%%%%AWS_STACK_PREFIX%%_register.citybridge.com%%AWS_STACK_POSTFIX%%.json","description":"A full file path of where to write out the expanded configuration file used\/cretecd by aws_bootstrap.py","type":"string"},"___AWS_STACK_POSTFIX":{"default":"-dev","type":"string","descripton":"The name of the prefix to apply to the stack service and IAM names"},"___AWS_STACK_NAME":{"default":"%%AWS_STACK_PREFIX%%_register.citybridge.com%%AWS_STACK_POSTFIX%%","type":"string","descripton":"The name of the stack"},"___AWS_STACK_REGION":{"default":"us-west-2","description":"AWS region that ELK stack lives in. Leave blank to skip monitoring ELK metrics","type":"string","enum":["us-west-2","us-west-1"]},"___AWS_ELB_SSL_KEY":{"default":{"_8_key_name_format":"%%AWS_STACK_NAME%%_grr_ssl","_8_iam_server_certificate_name":"%%AWS_STACK_NAME%%_grr_ssl","_8_iam_server_certificate_overwrite":true},"oneOf":[{"$eref":{"additioalProperties":false,"type":"object","properties":{"___public_key_file_path":{"description":"Full file path the the public key file","type":"string"},"___publickey_s3_bucket":{"default":"%%AWS_S3_DEFAULT_BUCKET%%","description":"The S3 bucket that the source code for the web application will be uploaded to","type":"string"},"___X509_key_file_path":{"description":"Full file path the the signed certificate for this key","type":"string"},"___private_key_file_path":{"description":"Full file path the the private key file","type":"string"},"___no_passphrase":{"default":false,"description":"FOR TESTING ONLY. Don't prompt for a passphrase on unlocking private key. Private keys with a passphrase will fail if set to true. Deafults to false.","type":"boolean"},"___publickey_s3_bucket_region":{"default":"%%AWS_STACK_REGION%%","description":"The region the S3 bucket will be in","type":"string"},"___iam_server_certificate_name":{"description":"Full file path the the public key file","type":"string"},"___publickey_s3_key":{"default":"keys\/%%AWS_STACK_PREFIX%%_register%%AWS_STACK_POSTFIX%%.citybridge.com.email.pub","description":"The key in the sourcebundle_s3_bucket where the source bundle will be uploaded to. in the format \/path\/to\/file\/filename.zip","type":"string"}},"required":["public_key_file_path","private_key_file_path"]}},{"$eref":{"additioalProperties":false,"type":"object","properties":{"___private_key_has_passphrase":{"default":true,"description":"Use a passphrase to lock the private key. User will be prompted. Defaults to true","type":"boolean"},"___signature":{"default":{},"description":"Details to use to create a self signed certificate","type":"object","properties":{"___stateOrProvinceName":{"default":"New Jersey","type":"string"},"___serialNumber":{"default":"%%DATE_UTC_EPOCH%%","type":["integer","string"]},"___organizationUnit":{"default":"Stragtegic Information","type":"string"},"___countryName":{"default":"US","type":"string"},"___localityName":{"default":"Holland","type":"string"},"___organizationName":{"default":"Banzai Institue","type":"string"},"___domainComponent":{"default":"*","type":"string"}}},"___key_directory":{"default":"%%temporary_directory%%%%SEP%%\/keys","description":"The directory to put the key files","type":"string"},"___key_size":{"multipleOf":256,"default":2048,"description":"The key size in bits. Defaults to 2048","type":"number","minimum":1024},"___publickey_s3_bucket":{"default":"%%AWS_S3_DEFAULT_BUCKET%%","description":"The S3 bucket that the source code for the web application will be uploaded to","type":"string"},"___publickey_s3_bucket_region":{"default":"%%AWS_STACK_REGION%%","description":"The region the S3 bucket will be in","type":"string"},"___iam_server_certificate_name":{"default":"grr","description":"Full file path the the public key file","type":"string"},"___key_name_format":{"default":"grr_%%DATE%%","description":"The format of the key pair naming. Will product [key_name_format].pub and [key_name_format].pem","type":"string"},"___publickey_s3_key":{"default":"keys\/%%AWS_STACK_PREFIX%%_register%%AWS_STACK_POSTFIX%%.citybridge.com.email.pub","description":"The key in the sourcebundle_s3_bucket where the source bundle will be uploaded to. in the format \/path\/to\/file\/filename.zip","type":"string"}},"required":[]}}],"description":"Infomration about the key pair used for HTTPS handling by the AWS Elastic Beanstalk Service. If AWS_ELB_ASSERT_SSL is true Leaving this raise an error"},"___AWS_S3_DEFAULT_BUCKET":{"default":"register.citybridge.com","description":"Default s3 bucket to use for file uploads","type":"string"},"___LOG_LEVEL":{"default":"INFO","description":"The verbosity of logging","type":"string","enum":["CRITICAL","ERROR","WARNING","INFO","DEBUG","NOTSET","SILENT"]},"___temporary_directory":{"default":"%%PWD%%%%SEP%%tmp%%SEP%%%%DATE%%-grrawsbootstrap\/","description":"A directory that can be used to create tempoaraty files","type":"string"},"___AWS_STACK_ELEMENTS":{"default":{},"description":"The name of the role and elements to deploy. Override default values to use existing services","type":"object","properties":{"___AWS_SERVICE_CLOUDWATCH_ALARM":{"default":"%%AWS_STACK_PREFIX%%_grr_cwalarm_queuehealth%%AWS_STACK_POSTFIX%%","description":"AWS CloudWatch alarm to monitor SQS health metrics","type":"string"},"___AWS_SERVICE_APIGATEWAY_KEYS":{"default":"%%AWS_STACK_PREFIX%%_grr_apikeys%%AWS_STACK_POSTFIX%%","description":"API Access tokens stored and manged by AWS API Gateway","type":"string"},"___AWS_SERVICE_DYNAMO_TABLE":{"default":"%%AWS_STACK_PREFIX%%_grr_table%%AWS_STACK_POSTFIX%%","description":"DynamoDB table to store client details","type":"string"},"___AWS_SERVICE_ELASTIC_BEANSTALK":{"default":{"_8_sourcebundle_files":["globalreach_registration.py","registrationutils.py","requirements.txt","aws_utils.py","schemas\/globalreach_registration.requestschema.json","schemas\/globalreach_registration.responseschema.json",".ebextensions\/environment.config"],"_8_sourcebundle_s3_key":"source\/%%AWS_STACK_PREFIX%%_register%%AWS_STACK_POSTFIX%%.citybridge.com.zip","_8_name":"%%AWS_STACK_PREFIX%%_grr_elasticbeanstalk%%AWS_STACK_POSTFIX%%"},"$eref":{"default":{},"description":"Elastic Beanstalk function running globalreach_registration","type":"object","properties":{"___name":{"default":"%%AWS_STACK_PREFIX%%_grr_sourcebundle%%AWS_STACK_POSTFIX%%","description":"The name of the resource","type":"string"},"___sourcebundle_app_root":{"default":"%%PWD%%%%SEP%%","description":"The directory that is the top of the application on the file system. Defaults to pwd","type":"string"},"___sourcebundle_s3_bucket_region":{"default":"%%AWS_STACK_REGION%%","description":"The region the S3 bucket will be in","type":"string"},"___sourcebundle_files":{"default":[],"type":"array","items":{"type":"string"}},"___sourcebundle_s3_bucket":{"default":"%%AWS_S3_DEFAULT_BUCKET%%","description":"The S3 bucket that the source code for the web application will be uploaded to","type":"string"},"___sourcebundle_s3_key":{"default":"source\/%%AWS_STACK_PREFIX%%_register%%AWS_STACK_POSTFIX%%.citybridge.com.zip","description":"The key in the sourcebundle_s3_bucket where the source bundle will be uploaded to. in the format \/path\/to\/file\/filename.zip","type":"string"}}}},"___AWS_IAM_ELASTIC_BEANSTALK_ROLE":{"default":"%%AWS_STACK_PREFIX%%_grr_elasticbeanstalk_role%%AWS_STACK_POSTFIX%%","description":"IAM Role for Elastic Beanstalk application running globalreach_registration","type":"string"},"___AWS_SERVICE_ELASTIC_LOAD_BALANCER":{"default":"%%AWS_STACK_PREFIX%%_grr_elb%%AWS_STACK_POSTFIX%%","description":"Elastic Load Balancer HTTPS \/ HTTP frontend","type":"string"},"___AWS_IAM_LAMBDA_ROLE":{"default":"%%AWS_STACK_PREFIX%%_grr_lambda_role%%AWS_STACK_POSTFIX%%","description":"IAM Role for Lambda function running globalreach_registration_sqsdrain","type":"string"},"___AWS_SERVICE_S3_BUCKET":{"default":"%%AWS_STACK_PREFIX%%-grr-bucket%%AWS_STACK_POSTFIX%%","description":"S3 Bucket where configuration and runtime data is stored","type":"string"},"___AWS_SERVICE_SQS":{"default":"%%AWS_STACK_PREFIX%%_grr_queue%%AWS_STACK_POSTFIX%%","description":"SQS queue to mediate between AWS Lambda and AWS Elastic Beanstalk","type":"string"},"___AWS_SERVICE_LAMBDA":{"default":{"_8_sourcebundle_files":["globalreach_registration_sqsdrain.py","globalreach_registration_sqsdrain.json"],"_8_sourcebundle_s3_key":"source\/%%AWS_STACK_PREFIX%%_register%%AWS_STACK_POSTFIX%%.citybridge.lambda.zip","_8_function_handler":"globalreach_registration_sqsdrain.lambda_handler","_8_name":"%%AWS_STACK_PREFIX%%_grr_lambda%%AWS_STACK_POSTFIX%%"},"$eref":{"default":{},"description":"Elastic Beanstalk function running globalreach_registration","type":"object","properties":{"___name":{"default":"%%AWS_STACK_PREFIX%%_grr_sourcebundle%%AWS_STACK_POSTFIX%%","description":"The name of the resource","type":"string"},"___sourcebundle_app_root":{"default":"%%PWD%%%%SEP%%","description":"The directory that is the top of the application on the file system. Defaults to pwd","type":"string"},"___sourcebundle_s3_bucket_region":{"default":"%%AWS_STACK_REGION%%","description":"The region the S3 bucket will be in","type":"string"},"___sourcebundle_files":{"default":[],"type":"array","items":{"type":"string"}},"___sourcebundle_s3_bucket":{"default":"%%AWS_S3_DEFAULT_BUCKET%%","description":"The S3 bucket that the source code for the web application will be uploaded to","type":"string"},"___sourcebundle_s3_key":{"default":"source\/%%AWS_STACK_PREFIX%%_register%%AWS_STACK_POSTFIX%%.citybridge.com.zip","description":"The key in the sourcebundle_s3_bucket where the source bundle will be uploaded to. in the format \/path\/to\/file\/filename.zip","type":"string"}}}}}},"___CLOUDFORMATION_TEMPLATE_S3":{"type":"object","properties":{"___key":{"default":"cloudformation\/%%AWS_STACK_PREFIX%%_register%%AWS_STACK_POSTFIX%%.citybridge.com.json","type":"string"},"___bucket":{"default":"%%AWS_S3_DEFAULT_BUCKET%%","type":"string"},"___region":{"default":"%%AWS_STACK_REGION%%","type":"string"}}},"___CLOUDFORMATION_TEMPLATE_LOCAL_OUTPUTFILE":{"description":"A full file path of where to write out the CloudFormation templace createdby aws_bootstrap.py script. Setting to 'stdout' will cause aws_bootstrap.py to output the file to stdout.   If left unset, no file will be written out.","type":"string"}},"required":[]}