{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "id": "http://www.dan-nixon.com/Hourai/schema/session.json#",
    "type": "object",
    "title": "Session",
    "options": {
        "disable_collapse": true
    },
    "definitions": {
        "location": {
            "type": "object",
            "properties": {
                "name": {
                    "title": "Name",
                    "type": "string",
                    "minLength": 3
                },
                "description": {
                    "title": "Description",
                    "type": "string",
                    "format": "textarea",
                    "options": {
                        "input_height": "100px"
                    }
                },
                "address": {
                    "title": "Address",
                    "type": "string",
                    "minLength": 10
                },
                "lat_lon": {
                    "title": "Coordinates",
                    "type": "string",
                    "format": "lat-lon",
                    "default": "0, 0"
                }
            },
            "required": [
                "name",
                "description",
                "address",
                "lat_lon"
            ],
            "additionalProperties": false
        },
        "weather_conditions": {
            "type": "object",
            "properties": {
                "wind_speed": {
                    "title": "Wind Speed",
                    "description": "Approximate wind speed",
                    "oneOf": [
                        {
                            "type": "string",
                            "enum": [
                                "none",
                                "gentle",
                                "moderate",
                                "strong",
                                "gale"
                            ]
                        },
                        {
                            "type": "number",
                            "minimum": 0
                        }
                    ]
                },
                "wind_direction": {
                    "title": "Wind Direction",
                    "description": "Approximate wind direction",
                    "oneOf": [
                        {
                            "type": "null"
                        },
                        {
                            "type": "string",
                            "enum": [
                                "N",
                                "NW",
                                "W",
                                "SW",
                                "S",
                                "SE",
                                "E",
                                "NE"
                            ]
                        },
                        {
                            "type": "number",
                            "minimum": 0,
                            "maximum": 360
                        }
                    ],
                    "default": null
                },
                "precipitation_quantity": {
                    "title": "Precipitation Quantity",
                    "description": "Approximate strength/quantity of precipitation",
                    "type": "string",
                    "enum": [
                        "none",
                        "low",
                        "moderate",
                        "high",
                        "severe"
                    ]
                },
                "precipitation": {
                    "title": "Precipitation",
                    "description": "Type of precipitation",
                    "oneOf": [
                        {
                            "type": "null"
                        },
                        {
                            "type": "string",
                            "enum": [
                                "none",
                                "rain",
                                "snow",
                                "sleet",
                                "hail"
                            ]
                        }
                    ],
                    "default": null
                },
                "visibility": {
                    "title": "Visibility",
                    "description": "Approximate visibility distance in metres",
                    "type": [
                        "null",
                        "number"
                    ],
                    "minimum": 0
                },
                "brightness": {
                    "title": "Brightness",
                    "description": "Approximate brightness",
                    "oneOf": [
                        {
                            "type": "null"
                        },
                        {
                            "type": "string",
                            "enum": [
                                "dark",
                                "shaded",
                                "moderate",
                                "bright"
                            ]
                        }
                    ],
                    "default": null
                }
            },
            "required": [
                "wind_speed",
                "wind_direction",
                "precipitation_quantity",
                "precipitation",
                "visibility",
                "brightness"
            ],
            "additionalProperties": false
        },
        "model_log": {
            "type": "object",
            "properties": {
                "model_name": {
                    "title": "Name",
                    "description": "Unique name of the model in use",
                    "type": "string",
                    "minLength": 2
                },
                "time": {
                    "title": "Duration",
                    "description": "Time in seconds this model was in use",
                    "type": "number"
                },
                "description": {
                    "title": "Description",
                    "description": "Notes about the use of this model",
                    "type": "string",
                    "format": "textarea",
                    "options": {
                        "input_height": "100px"
                    }
                }
            },
            "required": [
                "model_name",
                "time",
                "description"
            ],
            "additionalProperties": false
        },
        "incident": {
            "type": "object",
            "properties": {
                "timestamp": {
                    "title": "Timestamp",
                    "description": "Date and time the incident took place",
                    "type": "string",
                    "format": "date-time"
                },
                "type": {
                    "title": "Type",
                    "type": "string",
                    "enum": [
                        "model_fault",
                        "control_fault",
                        "video_fault",
                        "battery_fault",
                        "fuel_fault",
                        "operator_injury",
                        "spectator_injury",
                        "model_damage",
                        "other"
                    ],
                    "default": "model_fault"
                },
                "model": {
                    "title": "Model",
                    "description": "The model this incident relates to",
                    "type": "string"
                },
                "description": {
                    "title": "Description",
                    "type": "string",
                    "format": "textarea",
                    "minLength": 10,
                    "options": {
                        "input_height": "100px"
                    }
                }
            },
            "required": [
                "timestamp",
                "type",
                "description"
            ],
            "additionalProperties": false
        }
    },
    "properties": {
        "start": {
            "title": "Start time",
            "description": "Start of the session",
            "type": "string",
            "format": "date-time"
        },
        "end": {
            "title": "End time",
            "description": "End of the session",
            "type": "string",
            "format": "date-time"
        },
        "title": {
            "title": "Title",
            "type": "string",
            "minLength": 5
        },
        "description": {
            "title": "Description",
            "type": "string",
            "format": "textarea",
            "options": {
                "input_height": "100px"
            }
        },
        "location": {
            "title": "Location",
            "$ref": "#/definitions/location"
        },
        "weather_conditions": {
            "title": "Weather Conditions",
            "oneOf": [
                {
                    "type": "null"
                },
                {
                    "$ref": "#/definitions/weather_conditions"
                }
            ],
            "default": null
        },
        "models": {
            "title": "Models Used",
            "type": "array",
            "minItems": 1,
            "uniqueItems": true,
            "items": {
                "$ref": "#/definitions/model_log"
            }
        },
        "incidents": {
            "title": "Incidents",
            "type": "array",
            "items": {
                "$ref": "#/definitions/incident"
            },
            "options": {
                "collapsed": true
            }
        }
    },
    "required": [
        "start",
        "end",
        "title",
        "description",
        "location",
        "weather_conditions",
        "models",
        "incidents"
    ],
    "additionalProperties": false
}